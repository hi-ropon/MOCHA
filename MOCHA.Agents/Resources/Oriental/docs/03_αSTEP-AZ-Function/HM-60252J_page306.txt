ファイル名: HM-60252J_page306

<overview>
本ページは「11 グループ送信」に関する説明で構成されています。内容は主にテキストで、グループ送信の概要、構成、アドレス設定、親サーバーと子サーバーの役割、グループ設定方法について解説しています。加えて、グループ送信に関連するコマンドの説明が表形式で示されており、グループ送信の動作を示す簡単な図（クライアント、親サーバー、子サーバー間のクエリ送信とレスポンスの流れ）も含まれています。
</overview>

<contents>
### テキスト
#### 11 グループ送信
複数のサーバーでグループを組み、そのグループに対してクエリを一斉に送信する方法について説明しています。

##### ■グループの構成
- グループは親サーバー1台と子サーバーで構成される。
- 親サーバーのみがレスポンスを返す。

##### ■グループのアドレス
- グループ送信時は子サーバーに対してグループのアドレスを設定する。
- グループのアドレスを設定した子サーバーは親サーバーに送信されたクエリを受け取れる。
- 親サーバーは必須ではなく、子サーバーだけでグループを構成可能。
- クライアントからグループアドレスにクエリを送ると子サーバーが処理を実行するがレスポンスは返さない。
- ブロードキャストでは全サーバーが処理を実行するが、この方法では処理するサーバーを限定可能。

##### ■親サーバー
- 親サーバーのアドレスがグループのアドレスとなる。
- クライアントから親サーバーにクエリを送ると、親サーバーが処理しレスポンスを返す。
- ユニキャストモードと同様の動作。

##### ■子サーバー
- 親サーバーのアドレスを設定されたサーバーが子サーバーとなる。
- グループアドレスに送信されたクエリを受信し処理を実行するがレスポンスは返さない。
- グループ送信で実行可能なファンクションコードは「複数の保持レジスタへの書き込み(10h)」のみ。

##### ■グループの設定
- 親サーバーのアドレスを子サーバーの「グループID」に設定する。
- グループ変更はユニキャストモードで行う。
- 「グループID」の読み出しと書き込みは上位・下位を同時に行う必要がある。

### 図
```mermaid
flowchart LR
    クライアント -->|クエリ(親サーバー宛)| 親サーバー
    親サーバー -->|レスポンス| クライアント

    クライアント -->|クエリ(親サーバー宛)| 子サーバー
    子サーバー -->|処理するがレスポンスなし| クライアント
```

### 表
#### 関連するコマンド

| レジスタアドレス | 名称           | 内容                                         | READ/WRITE | 設定範囲                      |
| :---------------- | :------------- | :------------------------------------------- | :--------- | :---------------------------- |
| Dec 48 / Hex 0030h | グループID(上位) | グループのアドレス（親サーバーの号機番号）を設定 | R/W        | -1: 個別（グループ送信しない）<br>1～31: グループID |
| Dec 49 / Hex 0031h | グループID(下位) | 同上                                         | R/W        | 同上                         |

### 重要事項
- グループIDに「0」を設定しないこと。
- グループアドレスの変更はユニキャストモードで行うこと。
- グループ設定はRAMに保存されるため、ドライバの電源を切ると初期値に戻る。
</contents>