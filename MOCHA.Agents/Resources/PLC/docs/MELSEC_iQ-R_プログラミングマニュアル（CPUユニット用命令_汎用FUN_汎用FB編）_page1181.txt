ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1181

<overview>
本ページは、通信プロトコルにおけるキャンセル要求があった場合の動作を示した内容で構成されています。ページ全体はテキスト説明と2つのタイミング別のシーケンス図（グラフ）で構成されており、CPUユニットと外部機器間の通信パケット送信の流れとキャンセル処理の動作を示しています。表はなく、図はタイミングチャート形式のシーケンス図が2つ並んでいます。
</overview>

<contents>
### テキスト
- 送信前にキャンセル要求があった場合の動作説明
  - プロトコル実行状態が「2:送信中」で、送信が完了していない場合の動作
- 送信完了時にキャンセル要求があった場合の動作説明
  - プロトコル実行状態が「2:送信中」で、送信が完了している場合の動作

### 図（シーケンス図）
#### 1. 送信完了していない場合のキャンセル要求動作
- CPUユニット内のSP.ECPRTCL命令、完了デバイス(d)、完了時の状態表示デバイス(d)+1の状態遷移を示す。
- コネクション番号(s1)でプロトコルキャンセル指定が行われる。
- 送信待機時間内に「1:キャンセル要求」が発生。
- CPUユニットは送信パケットを送信し続けるが、外部機器側は送信パケットを中止。
- 送信中のパケットは中断せず送信完了する。
- キャンセル完了後、次の受信やプロトコルは実行されない。
- 完了デバイスは異常完了時にONになり、その後OFFに戻る。

#### 2. 送信完了している場合のキャンセル要求動作
- CPUユニット内のSP.ECPRTCL命令、完了デバイス(d)、完了時の状態表示デバイス(d)+1の状態遷移を示す。
- コネクション番号(s1)でプロトコルキャンセル指定が行われる。
- 送信待機時間内に「1:キャンセル要求」が発生。
- CPUユニットは送信パケットの送信を中止。
- 外部機器は送信パケットを受信。
- キャンセル完了後、次の受信やプロトコルは実行されない。
- 完了デバイスは異常完了時にONになり、その後OFFに戻る。

### ポイント
- キャンセル要求が送信中にあっても、送信完了していないパケットは中断されず送信完了する。
- 送信完了している場合は送信パケットの送信を中止できる。
- キャンセル完了後は次の受信やプロトコルは実行されない。
</contents>