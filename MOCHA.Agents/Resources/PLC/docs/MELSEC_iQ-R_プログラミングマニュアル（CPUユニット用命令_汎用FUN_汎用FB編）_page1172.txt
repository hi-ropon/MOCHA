ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1172

<overview>
本ページは「コントロールデータ」に関する説明で構成されており、テキスト部分と表部分、さらに動作の流れを示す図（シーケンス図）が含まれています。テキスト部分ではTCP受信モードの機能説明があり、表部分ではオペランド(s2)の各デバイスの項目と内容、設定範囲、セット側の情報が整理されています。図部分はTCP通常受信モードにおける受信データサイズ超過時の動作例を示しています。
</overview>

<contents>
### テキスト
#### コントロールデータ（オペランド：s2）
TCP通信に関するコントロールデータの説明です。UDP通信のコネクションには無効で、TCP通信のコネクションに対して設定されます。

##### 機能
- (s1)で指定したコネクションに対し、UDP通信以外のTCP受信モードおよび受信データサイズを変更可能。
- TCPコネクションは(s2)+2で指定したモードとなる。

##### TCP通常受信モード
- データ受信時、受信データをソケット通信受信データエリアに格納し、SD1506（ソケット通信受信状態信号）をONにする。
- 受信データが指定受信データサイズを超える場合、超過分は次の受信データとなる。
- SP.SOCRCV/S.SOCRCVS命令でデータを読み出すまでに受信したデータはOS内受信データに格納される。
- SP.SOCRCV/S.SOCRCVS命令でデータを取り出した際、OS内受信データに格納されたデータがあれば再度ソケット通信受信データエリアに格納し、SD1506をONにする。

### 表
| デバイス | 項目           | 内容                                                                 | 設定範囲  | セット側 |
|----------|----------------|----------------------------------------------------------------------|-----------|----------|
| +0       | システムエリア | —                                                                    | —         | —        |
| +1       | 完了ステータス | 命令完了時に完了ステータスを格納。<br>・0000H:正常完了<br>・0000H以外:異常完了(エラーコード) | —         | システム |
| +2       | TCP受信モード  | TCP受信モードを格納。<br>・0:TCP通常受信モード<br>・1:TCP固定長受信モード | 0, 1      | ユーザ   |
| +3       | 受信データサイズ | ソケット通信受信データサイズ（バイト数）を格納。                     | 1〜10238  | ユーザ   |

### 図（動作例）
#### 受信データサイズを300バイトに設定し、500バイト受信した場合の動作フロー
- ソケット通信受信データエリアに最初の300バイトを格納し、SD1506信号をONにする。
- SP.SOCRCV/S.SOCRCVS命令で300バイトを読み出すと、SD1506信号はOFFになる。
- 残りの200バイトを再度ソケット通信受信データエリアに格納し、SD1506信号をONにする。
- 再度SP.SOCRCV/S.SOCRCVS命令で200バイトを読み出すと、SD1506信号はOFFになる。

この流れにより、受信データが設定サイズを超えた場合でも、分割して受信データを処理できることを示しています。
</contents>