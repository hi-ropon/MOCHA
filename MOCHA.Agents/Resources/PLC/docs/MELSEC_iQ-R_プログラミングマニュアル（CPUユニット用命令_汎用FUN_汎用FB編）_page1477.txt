ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1477

<overview>
本ページは「39.5 文字列の挿入」についての説明で構成されています。ページ全体は以下のセクションに分かれています。
- テキスト部分：関数INSERT(_E)の概要説明、引数の内容・種別・データ型の説明、機能の詳細説明
- 図部分：ラダー、FBD/LDでの関数ブロック図、ST言語での記述例
- 表部分：引数の内容・種別・データ型をまとめた表
- 図（例示）：文字列挿入の動作例を示すメモリ配置の図解
グラフ部分はありません。
</overview>

<contents>
### テキスト
#### 39.5 文字列の挿入
INSERT(_E)関数は、文字列の間に別の文字列を挿入して出力します。

##### 対応CPU
RnCPU、RnENCPU、RnPCPU（プロセス・三重化・一般）、RnPSFCPU（安全・一般）、RnSfCPU（安全）に対応しています。

##### ラダー、FBD/LD、STでの使用例
- ラダー、FBD/LDでは、EN/ENO付き・なしの関数ブロック図が示されています。
- ST言語では、EN/ENOなしの場合は `d:=INSERT(s1,s2,n);`、EN/ENO付きの場合は `d:=INSERT_E(EN,ENO,s1,s2,n);` と記述します。

#### 設定データ
| 引数 | 内容 | 種別 | データ型 |
| :--- | :--- | :--- | :--- |
| EN | 実行条件(TRUE:実行、FALSE:停止) | 入力変数 | BOOL |
| s1(IN1)、s2(IN2) | 入力 | 入力変数 | ANYSTRING_SINGLE |
| n(P) | 挿入先頭位置指定 | 入力変数 | INT |
| ENO | 出力状態(TRUE:正常、FALSE:異常) | 出力変数 | BOOL |
| d | 出力 | 出力変数 | ANYSTRING_SINGLE |

#### 機能
- (s1)へ入力された文字列の先頭からn文字目（挿入先頭位置）に、(s2)へ入力された文字列を挿入し、(d)から出力します。
- (s2)の文字列を(s1)へ挿入後、(s2)の文字列の終了を示す00Hは無視されます。
- 挿入した文字列が255バイトを超えている場合は、255バイトまでの文字列を出力します。

##### 例
nへの入力値が4の場合の動作例が示されています。

- (s1)の文字列「ABCDE」の4文字目に(s2)の文字列「123456」を挿入すると、「ABC123456DE」となります。
- 図では、上位バイト・下位バイトごとに16進数でメモリ配置が示され、挿入位置の指定や挿入後の文字列の変化が視覚的に説明されています。

- (s1)、(s2)への入力値はSTRING型のデータ値で0～255バイトの範囲内です。
- nへの入力値はINT型のデータ値で1～255の範囲内です。ただし、(s1)へ入力される文字列の文字数以内に限ります。
</contents>