ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page631

<overview>
本ページは「データ処理」章の一部で、特に「データリード/ライト命令」に関する説明が中心です。ページ構成は以下の通りです。
- テキスト部分：SP.DEVST命令の機能説明、注意事項、エラー処理について詳細に記述。
- 図部分：データメモリ内のデバイスデータ格納用ファイルへの書き込みオフセットの概念図。
- 表部分：エラーコード（SD0）とその内容をまとめた表。
グラフはなく、主に命令の動作原理と注意点、エラー対応を文章と図表で解説している構成です。
</overview>

<contents>
### テキスト
#### 機能
- (s2)で指定したデバイスから(n)で指定した点数のデバイスデータを、データメモリ上のデバイスデータ格納用ファイルの(s1)で指定した書き込みオフセットに書き込みます。
- (s1)はデバイスデータ格納用ファイル先頭からのオフセットで、ワードオフセット（16ビットごとに+1する単位）で指定。
- 完了デバイス(d)は、SP.DEVST命令の処理完了を検出したEND命令実行時に自動的にONし、次のスキャンのEND命令でOFFされるため、実行完了フラグとして使用可能。
- 異常完了時は異常完了デバイス(d)+1が完了デバイス(d)と同じタイミングでON/OFFし、異常完了フラグとして使用。
- 実行中はSM753（ファイルアクセス中）がONとなり、既にONの場合はSP.DEVST命令を実行不可（無処理）。
- 実行時にエラー検出した場合は完了デバイス(d)、異常完了デバイス(d)+1、SM753はONしない。
- SP.DEVST命令使用時はデバイスデータ格納用ファイル設定が必要。
- 書き込まれたデバイスデータは、S(P).DEVLD命令で指定デバイスに読み出し可能。

#### 注意事項
- データメモリへ書き込む値はSP.DEVST命令実行時の値。
- 実行によりSD634、SD635（データメモリ書込み回数指標）が増加。上限は10万回で超過するとエラー（1080H）。
- 不用意な命令実行による書込み回数増加防止のため、SD771（書込み命令実行回数指定）で1日の書込み回数制限可能。デフォルトは36回。
- 制限超過時はエラー（3421H）。
- 書込み回数は電源OFF-ON時、時計データ変更時に0に初期化。
- 書込みタイミングはEND命令実行時。SP.DEVST命令実行直後のEND命令実行時に書込み。
- 書込み点数によっては複数スキャンに跨る場合があるため、完了デバイスで書込み完了を判断。

### 図
- データメモリ内のデバイスデータ格納用ファイルの書込みオフセットの概念図。
- (s2)で指定した範囲のデバイスデータを、(s1)で指定したオフセット位置に書き込むイメージ。
- 書込みオフセットは16ビット単位で+1ずつ増加。

### 表
#### エラーコード（SD0）と内容
| エラーコード(SD0) | 内容 |
|------------------|------|
| 2840H | パラメータにデバイスデータ格納用ファイルの設定をしていないとき。 |
| 3405H | (n)の設定データが0のとき。 |
| 3421H | SP.DEVST命令実行時に、当日の書込み回数がSD771で指定した値を超えたとき。<br>またはSD771に1～32767の範囲外の値が設定されているとき。 |

</contents>