ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page825

<overview>
本ページは文字列処理に関する説明で構成されており、主に以下の3セクションから成っています。
1. テキスト部分：シフトJIS文字列をUnicode文字列に変換する機能の説明、変換例、動作の概要。
2. 図部分：シフトJIS→Unicode変換の動作を示すラダー図とデータのビット構成例。
3. 表部分：エラーコードとその内容をまとめた表。
</overview>

<contents>
### テキスト
#### 機能
- (s)で指定したシフトJIS文字列をUnicode文字列に変換し、先頭にバイトオーダーマークを付加して(d)へ格納する。
- (s)のシフトJIS文字列はビッグエンディアンで指定する必要がある。
- (d)のUnicode文字列はリトルエンディアンで格納される。

#### 例
- シフトJIS文字列「95B6H」は「B695H」として指定する。
- Unicode文字列「6587H」は「6587H」として指定する。

#### シフトJIS→Unicode変換の動作
- ラダー図で、SM402がONのときに「$MOVP "文字列123" D0」を実行し、(s)のD0から(d)のD100へ「SJIS2WSBP」命令で変換を行う。
- (s)のデータはビッグエンディアンで格納され、(d)のデータはリトルエンディアンで格納される。
- バイトオーダーマーク（FFFFEH）がUnicode文字列の先頭に付加される。

### 図
- シフトJIS文字列「95B6H」のビット構成例：b15～b8がB6H、b7～b0が95H。
- Unicode文字列「6587H」のビット構成例：b15～b8が65H、b7～b0が87H。
- ラダー図：SM402がONでMOVP命令、M0がONでSJIS2WSBP命令を実行し、D0のシフトJIS文字列をD100のUnicode文字列に変換。
- 変換後のUnicode文字列はバイトオーダーマークFFFFEHを先頭に持ち、その後に文字データがリトルエンディアンで格納されている。

### 表
#### エラーコード（SD0）と内容
| エラーコード | 内容 |
| :--- | :--- |
| 2821H | (s)、(d)で指定した範囲が重複している場合。 |
| 3401H | (s)で指定した範囲に変換できない文字コードが含まれている場合。 |
| 3405H | (s)で指定した文字列が16,383文字を超える場合。 |

*注記*  
漢字などのシフトJISコードで表現した場合に2バイトデータになる文字は、1文字あたり2とカウントする。
</contents>