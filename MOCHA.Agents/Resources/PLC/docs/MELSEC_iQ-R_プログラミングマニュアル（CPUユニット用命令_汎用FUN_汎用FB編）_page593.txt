ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page593

<overview>
このページは、EFCALL(P)命令の機能説明に関するテキスト部分、命令の動作を示すラダープログラムの例の図、及びタイミングチャートのグラフで構成されています。テキスト部分ではEFCALL(P)命令の概要、非実行処理の説明、演算結果のデバイス別挙動、使用上の注意点が記載されています。図はメインルーチンプログラムとサブルーチンプログラムの関係や、EFCALL命令を使ったラダープログラム例を示しています。グラフは各信号のON/OFFタイミングを視覚的に表現しています。
</overview>

<contents>
### テキスト
#### EFCALL(P)命令の機能
- EFCALL(P)命令を実行すると、(P)で指定されたポインタのサブルーチンプログラムの非実行処理を行う。
- EFCALL(P)命令は他のプログラムファイルのローカルポインタを使ったサブルーチンプログラム呼び出しも可能。
- 非実行処理とは、各コイル命令を条件接点がOFF状態と同一の処理を行うこと。
- 非実行処理後の各コイル命令の演算結果は条件接点のON/OFFに関係なく以下のようになる。

| 演算で使用するデバイス | 演算結果（デバイスの状態） |
|-------------------------|-----------------------------|
| 高速タイマ、低速タイマ | 0となる |
| 高速積算タイマ、低速積算タイマ、カウンタ | 現在の状態を保持 |
| OUT命令中のデバイス | 強制的にOFF |
| SET命令、RST命令中のデバイス、SFT(P)命令中のデバイス、基本/応用命令中のデバイス | 現在の状態を保持 |
| PLS命令、パルス化命令（□P） | 条件接点OFFと同一処理 |

- EFCALL(P)命令はECALL(P)命令と組み合わせて使用し、ECALL(P)命令と組み合わせずに実行しない場合は、実行指令をOFFにしてもサブルーチンプログラムの非実行処理は行われず、各コイル命令の出力状態を保持する。
- 実行指令がOFFになるとサブルーチンプログラムの非実行処理を行うため、OUT命令やPLS命令（パルス化命令含む）を強制的にOFFにできる。

### 図
#### メインルーチンプログラムとサブルーチンプログラムの関係図
- メインルーチンプログラム（ファイル名：MAIN）内にEFCALL "ABC" (P)命令があり、(P)で指定されたサブルーチンプログラム（ファイル名：ABC）を呼び出す。
- サブルーチンプログラムはRET命令で終了。
- (1)の注釈で、EFCALL(P)命令の指令がON→OFF時に非実行処理が行われることを示す。

#### ラダープログラム例（[ABC.PRG]）
- X0がONのとき、ECALL "ABC" P0とEFCALL "ABC" P0が並列に実行される。
- P0のプログラムはX1がONのときY10をFENDし、SET Y11、PLS M0を実行し、RETで終了。
- (1)の注釈はEFCALL命令による強制OFFを示す。

### グラフ
- X0、X1、Y10、Y11、M0の信号のタイミングチャート。
- X0、X1、Y10はパルス状にON/OFFを繰り返し、Y11はX1がONの間ONを保持。
- M0はPLS命令によるパルス信号で、(1)の位置でEFCALL命令による強制OFFが発生していることを示す。

</contents>