ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page662

<overview>
本ページは「CSV形式書込み（文字列(アスキーデータ)）」の例を中心に構成されている。テキスト部分では命令の説明と注意点が記載されている。表部分ではコントロールデータの各項目の内容が示されている。図部分では命令の構造とデータの流れ、及びCSVファイルの書き込みイメージが示されている。
</overview>

<contents>
### テキスト
#### CSV形式書込み（文字列(アスキーデータ)）の例
実行/完了タイプで「文字列(アスキーデータ)」を指定した場合の例を示す。

- 命令例: `SP.FWRITE U0 K2 D10 "ABCD" D99 M0`
  - (1) 書き込むデータ
  - (2) ファイル名
  - (3) コントロールデータ

##### コントロールデータの内容
| 項目 | 内容 |
| --- | --- |
| D10 | 実行/完了タイプ：文字列(アスキーデータ) |
| D11 | 完了ステータス |
| D12 | 書込み結果データ数 |
| D13 | 未使用 |
| D14, D15 | ファイル位置 |
| D16 | 列数指定 |
| D17 | データタイプ指定 |

| 項目 | 内容 |
| --- | --- |
| D99 | 要求書込みデータ数 |
| D100～D102 | 1行目第1列～第3列に書き込む文字列 |
| D103～D104 | 2行目第1列～第3列に書き込む文字列 |
| D105～D106 | 3行目第1列～第3列に書き込む文字列 |

##### Point
- 1要素の文字列の終端には必ず00H(NULL)を設定すること。文字列が偶数バイトの場合は次の1ワードに0000H(2バイト分のNULL)を設定する。
- 1要素の最大文字数は1999文字。これを超え00H(NULL)が格納されていない場合は2000文字目以降は書き込まれず、次の要素の書込みが行われる。
- 1回の命令実行で書込み可能な要素数の最大は1023。

### 図
- 命令の構造図：`SP.FWRITE`命令における各パラメータの役割を矢印で示し、書き込むデータ、ファイル名、コントロールデータの関係を表現。
- コントロールデータの各Dレジスタの値を示す表。
- 書き込むCSVファイルのイメージ図：1行目に"ABCD", "123", "456"がカンマ区切りで書き込まれている様子をExcelの表形式で表現。

### 表
#### コントロールデータ詳細
| レジスタ | 内容 |
| --- | --- |
| D10 | 実行/完了タイプ（文字列(アスキーデータ)） |
| D11 | 完了ステータス |
| D12 | 書込み結果データ数 |
| D14, D15 | ファイル位置 |
| D16 | 列数指定 |
| D17 | データタイプ指定 |
| D99 | 要求書込みデータ数 |
| D100～D106 | 書き込む文字列データ（複数列対応） |

以上の内容により、CSV形式で文字列データを書き込む命令の具体例とその制約、コントロールデータの構成が理解できる。
</contents>