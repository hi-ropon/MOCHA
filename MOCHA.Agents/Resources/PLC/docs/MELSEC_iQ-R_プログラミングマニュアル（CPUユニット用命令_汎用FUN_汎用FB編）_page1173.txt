ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1173

<overview>
本ページは「TCP固定長受信モード」に関する説明で構成されています。主にテキストによる詳細な解説が中心で、TCP固定長受信モードの動作原理や受信データの取り扱いについて述べられています。加えて、受信データサイズに関する例示を含む図が1点あり、受信データの格納状況や信号のON/OFF状態を時系列で示しています。最後に、ポイントとしてデバイスの有効活用や受信データの分割防止・結合防止に関する注意点が箇条書きでまとめられています。
</overview>

<contents>
### テキスト
#### TCP固定長受信モードの概要
TCP固定長受信モードでは、受信したデータをソケット通信受信データエリアに格納します。指定された受信データサイズに達していない場合、SD1506（ソケット通信受信状態信号）はONになりません。受信データが指定サイズに達するまで受信を繰り返し、サイズに達した時点でSD1506がONになります。

受信データが指定サイズを超えた場合、超えた分の受信データは次の受信データとして扱われます。SP.SOCRCV/S.SOCRCVS命令でソケット通信受信データエリアからデータを読み出すと、OS内受信データに格納されます。読み出し後、OS内受信データがあれば再度ソケット通信受信データエリアに格納されますが、指定サイズに達していなければSD1506はONになりません。

#### 例示
受信データサイズを300バイトに設定し、200バイト連続受信した場合の動作を図で説明しています。

- 200バイト受信時点では受信データサイズに達していないため、データ読出しはできません。
- その後300バイト受信するとSD1506がONになり、データ読出しが可能になります。
- 残りの100バイトは次のデータ受信時（200バイト）に一緒に格納されます。

#### Point（ポイント）
- **デバイスの有効活用**  
  SP.SOCRCV/S.SOCRCVS命令で使用する受信データ格納用デバイスは、デフォルトで1024ワード確保が必要ですが、受信データサイズを1024ワード以下に指定することでデバイスを有効活用できます。

- **受信データの分割防止**  
  回線種類によってはデータが分割されて到達することがありますが、TCP固定長受信モードで受信データサイズを指定することで分割を防止可能です。

- **受信データの結合防止**  
  シーケンスプログラムの受信処理遅延などにより、分割送信したデータが結合される場合がありますが、TCP固定長受信モードで受信データサイズを指定することで正しく分けて受信できます。

#### 補足
- (s2)+3で1回のSP.SOCRCV/S.SOCRCVS命令で読み出す受信データサイズを指定します。
- UDPの場合、受信データが指定サイズを超えると超えた分は次の受信データになります。

### 図
- 図は受信データサイズ300バイトに対し200バイト連続受信した場合の受信データ格納状況を示しています。
- ソケット通信受信データエリアに200バイトが格納されている状態ではSD1506信号はOFFで、データ読出しはできません。
- 300バイト受信後にSD1506信号がONになり、データ読出しが可能となります。
- 残りの100バイトは次の受信時（200バイト）に一緒に格納されることが示されています。
</contents>