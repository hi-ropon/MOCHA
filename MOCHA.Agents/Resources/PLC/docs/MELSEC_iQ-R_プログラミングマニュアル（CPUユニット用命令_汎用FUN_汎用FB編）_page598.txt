ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page598

<overview>
このページは、サブルーチンプログラムにおけるファンクションデバイス（FX、FY、FD）の使用方法について説明しています。ページ構成は、テキスト説明、命令の動作を示すラダー図、ファンクションデバイスのデータサイズをまとめた表、そして具体例を示すラダー図と説明文で構成されています。
</overview>

<contents>
### テキスト
#### サブルーチンプログラムでのファンクションデバイス使用時のデバイス指定
- サブルーチンプログラムでファンクションデバイス（FX、FY、FD）を使用する場合、(s1)～(s5)で対応するデバイスを指定します。
- (s1)～(s5)で指定されたデバイスの内容は以下の通りです。
- サブルーチンプログラム実行前に、ビットデータの内容がFXに、ワードデータの内容がFDに転送されます。
- 実行後はFY、FDの内容が対応するデバイスに転送されます。
- FX、FYのファンクションデバイスの処理単位はビット単位、FDの処理単位は4ワード単位です。
- 指数で指定されたデバイスの種類により取り扱うデータサイズが異なり、データサイズが確保できない場合はエラーとなります。

#### ファンクションデバイスのデータサイズ
| ファンクションデバイス | 使用デバイス                     | データサイズ   |
|------------------------|---------------------------------|----------------|
| FX, FY                 | ビットデバイス                 | 1点            |
|                        | ワードデバイスのビット指定時   | 1ビット        |
| FD                     | ビットデバイスの桁指定時*2    | 4ワード*3      |
|                        | ワードデバイス                 | 4ワード*3      |

*2 ビットデバイスの桁指定時でも、(s1)～(s5)で指定されたデバイス番号が16の倍数でなくてもエラーになりません。  
*3 使用する命令により異なります。

#### 例：指定されたデバイスの内容
- ラダー図にて、X0がトリガーとなり、XCALL命令でP0を呼び出し、M0、D0、D30がそれぞれFX0、FD1、FD2に転送される様子を示しています。
- (1) M0を占有（FX0へ転送）  
- (2) D0～D3を占有（FD1へ転送）  
- (3) D30～D33を占有（FD2へ転送）

#### XCALL命令の使用上の注意
- XCALL命令では(s1)～(s5)まで使用可能。
- サブルーチンプログラムで使用しているファンクションデバイス数とXCALL命令の引数は同数にする必要がある。
- ファンクションデバイスとXCALL命令の引数の種類は同じにすること。
- XCALL命令で指定されたデバイス番号は重複しないようにする。重複すると正常に演算できない。
- XCALL命令のネスティングは16重まで可能。ただし16重はCALL(P)、FCALL(P)、ECALL(P)、EFCALL(P)、XCALL命令の合計。

### 図（ラダー図）
- 上部のラダー図は、X10の入力でXCALL命令がP0を呼び出し、FX0がM0に転送され、D0がFD1に、D100がFD2に対応していることを示す。
- 下部のラダー図は、XCALL命令のネスティング例を示し、P0がP10を呼び出し、さらにP10がP20を呼び出す構造を表現。各呼び出しはRET命令で終了。

</contents>