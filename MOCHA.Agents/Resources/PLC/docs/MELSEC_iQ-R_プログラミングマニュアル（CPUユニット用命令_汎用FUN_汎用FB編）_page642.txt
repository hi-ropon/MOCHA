ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page642

<overview>
本ページはCSV形式の変換読出しに関する説明で構成されている。テキスト部分では、CSV形式変換読出しの例としてExcelで作成したデータの構造と、CSV形式で保存した場合のデータ構造について説明している。表部分では、コントロールデータおよび読み込まれたデータの各項目の意味を詳細に示している。図部分では、ExcelデータからCSV保存、さらにデバイスに読み込まれるデータの流れを矢印で示し、各データの対応関係を視覚的に表現している。
</overview>

<contents>
### テキスト
#### CSV形式変換読出しの例（10進数16ビットデータ指定時に指定列数が0の場合）
Excelで作成したデータ例として、「大／小項目」と「測定値」の2列のデータが示されている。  
- 1行目は項目名（大／小項目、測定値）  
- 2行目以降に「長さ」「温度」といった項目名とそれに対応する数値データ（長さは1と3、温度は-21）が入力されている。

このExcelデータをCSV形式で保存すると、各セルの間にカンマ「,」が入り、行末にCR（復帰）とLF（改行）が付加される形式になる。

#### デバイスに読み込まれるデータの構造
SP.FREAD命令を用いて、U0、K2、D10、"ABCDE"、D99、M0の順にデータが読み込まれる。  
- (1) 読み込まれたデータ  
- (2) ファイル名  
- (3) コントロールデータ  

### 表
#### コントロールデータの内容
| 項目 | 内容 |
| :--- | :--- |
| D10 | 実行／完了タイプ |
| D11 | 完了ステータス |
| D12 | 要求読出しデータ数 |
| D13 | 最大読出しデータ数 |
| D14, D15 | ファイル位置 |
| D16 | 列数指定 |
| D17 | データタイプ指定 |

#### 読み込まれたデータの内容
| 項目 | 内容 |
| :--- | :--- |
| D99 | 読出し結果データ数 |
| D100 | 「大／小項目」は数値以外のデータであるため、変換データ(0)が格納される。 |
| D101 | 「,」は数値以外のデータであるため、変換データ(0)が格納される。 |
| D102 | 「測定値」は数値以外のデータであるため、変換データ(0)が格納される。 |
| D103 | 「長さ」は数値以外のデータであるため、変換データ(0)が格納される。 |
| D104 | 「1」は数値であるため、バイナリ値に変換される。 |
| D105 | 「3」は数値であるため、バイナリ値に変換される。 |
| D106 | 「温度」は数値以外のデータであるため、変換データ(0)が格納される。 |
| D107 | 「-21」は数値であるため、バイナリ値に変換される。 |
| D108 | 「,」は数値以外のデータであるため、変換データ(0)が格納される。 |

### 図
- Excelで作成した表形式のデータがCSV形式に変換される過程を示している。  
- CSV形式のデータはカンマ区切りで、行末にCR LFが付加されている。  
- その後、SP.FREAD命令によりデバイスに読み込まれるデータの構造を示し、読み込まれたデータ、ファイル名、コントロールデータの3つの要素に分かれていることを矢印で示している。  
- コントロールデータと読み込まれたデータの各項目の意味が表形式で詳細に説明されている。
</contents>