ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1196

<overview>
本ページは、ファイル転送機能用命令「SP.FTPPUT命令」に関する説明で構成されています。ページ全体は主にテキストで構成されており、ファイルパスの指定方法やワイルドカードの使用ルールについて詳細に解説しています。図はファイルパスの文字列構造を示したもので、表はワイルドカードの記号とその意味をまとめています。グラフはありません。
</overview>

<contents>
### テキスト
#### SP.FTPPUT命令のファイル指定方法
- SP.FTPPUT命令で処理するファイルの総数は、(s1)+2の「処理ファイル総数」に格納され、処理完了したファイル数は(s1)+3の「処理完了ファイル数」に格納される。
- (s2)にはCPUユニットの転送元ドライブNo.2～4とファイルが格納されているフォルダパス、ファイル名（拡張子含む）をUnicode文字列で指定する。
- ファイルパスの長さは最大255文字で、ファイル名を除いたパスの長さは最大246文字。
- ドライブ、フォルダパス、ファイル名の区切り文字は半角の「￥」または「/」を使用。

#### ワイルドカード指定
- (s2)で指定したファイル名または拡張子にはワイルドカード「*」「?」が使用可能。
- 「*」は指定位置から任意の文字列（なしも含む）すべてのファイルを対象。
- 「?」は指定位置から任意の1文字（なしは含まない）すべてのファイルを対象。複数使用可能。
- ピリオドはワイルドカード指定不可。
- ワイルドカード指定の誤り例：
  - ファイル名や拡張子に「*」を2個以上使用（例：「*abc*.txt」）
  - 「*」と「?」が混在（例：「*ab?.txt」）

#### 転送可能ファイル数の計算
- 転送可能ファイル数は指定ファイルのファイル名サイズ合計で決まる。
- 転送可能ファイル数の計算式は (Fi+NM)+1 < 65536バイト
  - N：ワイルドカードに一致するファイル数
  - Fi：ワイルドカードに一致するファイル名合計サイズ
  - M：特定情報サイズ（固定6バイト）

#### エラーと転送中断
- 転送中に1ファイル送付でエラー発生時は転送中止、残りファイルは送信されない。
- 転送不可ファイルはワイルドカード条件に合致しても転送対象外。
- ファイルパスが255文字超過時も転送対象外。

#### (s3)のFTPサーバ転送先フォルダパス指定
- FTPサーバのホームディレクトリからの相対パスをUnicode文字列で指定。
- 区切り文字は半角「￥」または「/」を使用。
- フォルダパス長は最大255文字。
- フォルダパス（末尾区切り文字含む）と(s2)のファイル名部分の合計はFTPサーバの最大パス長を超えないように指定。
- 末尾区切り文字は省略可能、省略時は「￥」が設定されていると見なす。
- 存在しないフォルダパスの場合はシステムが自動作成しファイル転送を行う。

### 図
- ファイルパスの文字列構造を示す図
  - 例：「2:￥database1￥recipe￥recipe_db.txt」
  - (1) ドライブNo.は2～4（R00CPUのみ3,4）
  - (2) ドライブNo.の区切り文字は「:」または「/」
  - (3) フォルダパス、ファイルの区切り文字は半角「￥」または「/」
  - (4) 指定ファイル名は拡張子を含む
- 文字列はUnicode文字列で最大255文字まで
- 文字列の終端は0000Hで示す

### 表
| 記号 | 内容 |
| :--- | :--- |
| * | 指定位置から任意の文字列（なしも含む）すべてのファイルを対象 |
| ? | 指定位置から任意の1文字（なしは含まない）すべてのファイルを対象。複数使用可 |

</contents>