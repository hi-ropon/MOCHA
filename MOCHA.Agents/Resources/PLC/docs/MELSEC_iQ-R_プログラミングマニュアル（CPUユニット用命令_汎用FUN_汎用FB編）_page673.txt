ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page673

<overview>
このページは「ファイル操作命令」に関する説明で構成されています。主にテキスト部分で機能の詳細、注意事項、エラーについて記載されています。表部分ではエラーコードとその内容が整理されています。グラフや図は含まれていません。
</overview>

<contents>
### テキスト
#### 機能
- (s1)で指定したドライブの(s2)で指定したファイルまたはフォルダを、(s3)で指定したドライブの(s4)で指定したフォルダにコピーする。
- (s2)にフォルダを指定した場合、コピー先に同名のファイルやサブフォルダが存在すると、(d1)のビット1の値（上書き設定）が0であればコピーは異常完了しない（コピーをスキップ）。
- (s4)で指定したコピー先のフォルダが存在しない場合は自動で作成される。
- SP.FCOPY命令実行中はSM753（ファイルアクセス中）がONになる。SM753がON中はSP.FCOPY命令は実行不可（実行しても無処理）。
- 処理完了(d2)のビットデバイスは、SP.FCOPY命令の処理完了を検出したスキャンのEND命令実行時に自動的にONし、次のスキャンのEND命令でOFFになる。
- SP.FCOPY命令が異常完了(d2)+1のデバイスが、処理完了(d2)のデバイスと同じタイミングでON/OFFする。
- 命令実行時に演算エラーを検出した場合、処理完了(d2)、異常完了(d2)+1はONしない。

#### 注意事項
- SP.FCOPY命令は割込みプログラム中では実行しないこと。割込みプログラムで実行すると誤動作の原因になる。
- 命令実行中にCPUユニットの状態をRUN→STOPに変更しても命令は処理を継続する。
- コピー後のフォルダパスやファイル名、フォルダパスは文字数制限を超えないようにすること。超えるとアクセス不可やエラーになる場合がある。
- 命令処理途中で異常完了した場合、ファイルやフォルダが処理中の状態で残ることがある。
- コピー対象ファイルのサイズや数が大きいと命令完了まで時間がかかる。
- SP.FCOPY命令で操作中のファイルには他機能からアクセスしないこと。ファイル破損やエラーの原因になる。
- 他機能からアクセスしているファイルやフォルダへの操作は行わないこと。

### 表
#### エラーコード（SD0）と内容

| エラーコード | 内容 |
| --- | --- |
| 3405H | ドライブ指定(s1)、(s3)で指定したドライブがSDメモリカード以外の場合。<br> (s2)で指定したファイル名/フォルダ名文字列が読み出せない場合：<br> ・ファイル名文字列が1文字以上指定されていない<br> ・ファイル名文字列が254文字以上<br> ・フォルダパスが245文字以上<br> ・フォルダパスに11以上の階層指定<br> ・ファイル名文字列の末尾に区切り文字を指定<br> ・ファイル名文字列の末尾または区切り文字の直前に半角ピリオドがある<br> (s4)で指定したフォルダパス文字列が読み出せない場合：<br> ・フォルダパス文字列が1文字以上指定されていない<br> ・フォルダパス文字列が245文字以上<br> ・フォルダパス文字列に11以上の階層指定<br> ・フォルダパス文字列の末尾または区切り文字の直前に半角スペースや半角ピリオドがある<br> (s2)、(s4)で指定したフォルダパス内にルートフォルダ直下のシステムフォルダ($MELPRJ$)を指定した場合 |

- SP.FCOPY命令が異常完了した場合、完了ステータス(d1)+1で指定したデバイスにエラーコードが格納される（演算エラーの場合は格納されない）。
- 詳細なエラーコードは687ページの「ファイル操作命令で発生するエラーコード」を参照。

</contents>