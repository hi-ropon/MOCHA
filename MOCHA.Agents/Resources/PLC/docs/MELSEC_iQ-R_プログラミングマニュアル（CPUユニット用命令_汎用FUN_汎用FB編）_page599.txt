ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page599

<overview>
このページは、XCALL命令の引数に使用したデバイスの取り扱いに関する説明で構成されています。ページ全体は以下の3つのセクションから成ります。
1. テキスト部分：XCALL命令の引数に使用したデバイスをサブルーチンプログラムで使用してはいけない旨の注意書きとその理由の説明。
2. 図部分：サブルーチンプログラムの動作例を示すラダー図と、各ステップでのデバイスの値の変化を示す図解。
3. 表や数値データはなく、図解とテキストで動作の流れを説明している構成。
</overview>

<contents>
### テキスト
- XCALL命令の引数に使用したデバイスは、サブルーチンプログラムで使用してはいけない。
- もしXCALL命令の引数に使用したデバイスをサブルーチンプログラムで使用した場合、正常な演算ができなくなる。

### 図・動作例の説明
- 【例】として、誤った演算例が示されている。
- サブルーチンプログラムのFD0にD0を指定し、サブルーチンプログラムでD1を使用した場合の動作をラダー図で表現。
- ラダー図の内容：
  - P0プログラム内でM0がONのとき、XCALL命令でP0のサブルーチンプログラムを呼び出し、引数にP0のD0を渡す。
  - サブルーチンプログラム内ではM0がONのとき、FD0をインクリメントし、K100を加算してD1に格納し、RET命令で戻る。

- サブルーチンプログラム実行前からRET命令実行後までの各デバイスの値の変化を4つの状態図で示している。
  1. サブルーチンプログラム実行前：
     - D0=0,10,100,1000
     - D1=10
     - D2=100
     - D3=1000
     - FD0は不定(灰色で示されている)
  2. XCALL命令実行直後：
     - D0, D1, D2, D3は変わらず
     - FD0はD0の値が転送される（0,10,100,1000）
  3. サブルーチンプログラム実行時：
     - D0はD1の値110に更新されている（110はK100+10）
     - FD0は1に更新されている
  4. RET命令実行後：
     - D0は1に更新されている（サブルーチンの実行結果）
     - D1, D2, D3は元の値のまま（10,100,1000）
     - FD0は不定のまま

- 注釈：
  1. サブルーチンプログラムの実行結果が格納される。
  2. ファンクションデバイスの値に置き換わる。
  3. D1はファンクションデバイスの値が反映されない。
  4. 不定になる。

- まとめとして、XCALL命令の引数に使用したデバイスをサブルーチンプログラム内で使用すると、値の転送や反映に問題が生じ、正常な演算ができなくなることを示している。
</contents>