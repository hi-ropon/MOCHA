ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1596

<overview>
本ページは「モード切換え時のプログラム例」を示しており、テキスト部分、表部分、グラフ部分で構成されています。  
テキスト部分ではプログラムの概要説明とポイント解説があり、表部分ではPID演算に使用する各種デバイスの設定内容がまとめられています。  
グラフ部分では手動モードから自動モードへの設定値(SV)の段階的な書換え方法を示す折れ線グラフが掲載されています。
</overview>

<contents>
### テキスト
#### モード切換え時のプログラム例
自動モードと手動モードを切り換えながらPID演算を行うプログラム例を示しています。  
プログラム条件として、PID演算のループ数やサンプリング周期、使用するデバイスの範囲や役割が記載されています。

##### Point
自動モードから手動モードに切り換えると、PID演算時に自動的に設定値(SV)が測定値(PV)に書き換わるため、  
手動モードから自動モードに戻す場合は、設定値(SV)を手動モードに切り換える前に自動モードで制御していた値に書き換えます。  
設定値(SV)は1回で書き換えず、10回に分けて段階的に行うことが推奨されています。

### 表
#### プログラム条件一覧

| 項目 | 不完全微分 | 完全微分 |
| :--- | :--- | :--- |
| PID演算を行うループ数 | 1本 | 1本 |
| サンプリング周期 | 1秒 | 1秒 |
| PID制御用データを設定するデバイス | 共通データ | D500～D501 |  |
| ループ1用データ | D502～D515 | D502～D511 |
| 入出力データを設定するデバイス | 共通データ | D600～D609 |  |
| ループ1用データ | D610～D630 | D610～D627 |
| 外部のデジタルスイッチにより設定する設定値(SV)、および手動モード時の操作量(MV) | 設定値(SV) | X30～X3F |  |
|  | 手動モード時の操作量(MV) | X20～X2F |  |
| PID制御の開始/中止時に使用するデバイス | PID制御開始指令 | X0 |  |
|  | PID制御中止指令 | X1 |  |
| 自動/手動切換え指令に使用するデバイス | 設定値(SV)設定指令 | X3 |  |
|  | 手動モード時の操作量(MV)設定指令 | X4 |  |
|  | 自動/手動切換え指令 | X6 (OFF:自動モード、ON:手動モード) |  |
| R60AD4, R60DA4のデジタル値 | 0～2000 |  |
| SM792, SM794 | OFF |  |

### グラフ
#### 設定値(SV)の段階的書換えイメージ
- 横軸は時間（秒）、縦軸は設定値(SV)の値を示す折れ線グラフ。  
- 自動モード時のSVから手動モード時のSVへ10秒かけて1秒ごとに段階的に減算しながら書き換える様子を示しています。  
- 手動/自動切換え指令のタイミングでSVが変化し、1秒ごとに減算値を適用して徐々にSVを移行させる動作を表現。

#### 設定値(SV)の書換え演算式
\[
\frac{SV_m - SV_a}{10} = 減算値 \quad \dots \quad 余り
\]

- \(SV_m\): 手動モード時のSV  
- \(SV_a\): 自動モード時のSV  
- 設定値(SV)の減算は1秒ごとに行い、余りは1回目の減算時に同時に減算する。

以上により、モード切換え時のPID制御における設定値のスムーズな移行方法を示しています。
</contents>