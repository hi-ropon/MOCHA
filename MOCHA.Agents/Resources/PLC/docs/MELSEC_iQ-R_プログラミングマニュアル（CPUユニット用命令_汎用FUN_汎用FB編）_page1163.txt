ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1163

<overview>
本ページは内蔵Ethernet機能用命令の一部である「ソケット通信受信命令」に関する説明で構成されています。ページ全体は以下のセクションに分かれています。
- テキスト部分：受信データサイズのデフォルト値や注意点、機能説明、注意事項、エラーコードの説明が記載されています。
- 図部分：CPUユニット内の受信データ格納構造と、S.SOCRCVS命令を使用した受信処理のタイミングを示すシーケンス図が掲載されています。
- 表部分：エラーコードとその内容をまとめた表が掲載されています。
グラフ部分はありません。
</overview>

<contents>
### テキスト
#### Point
- 受信データサイズのデフォルトは2046バイトである。2047バイト以上のデータを受信する場合は、SP.SOCRMODE命令で受信データサイズを変更する必要がある。
- 奇数バイトのデータを受信した場合、最後の受信データを格納したデバイスの上位バイトには無効なデータが入る。

#### 機能
- (s)で指定したコネクションの受信データを、ソケット通信受信データエリア（コネクション毎にある相手機器から受信したデータを格納するエリア）から読み出す。
- S.SOCRCVS命令を使用した受信処理のタイミングは図の通りである。

#### 注意事項
- 同一コネクションに対する受信データの読出しをする場合、SP.SOCRCV命令と併用しないこと。

#### Point
- 膨大なデータを受信しないために、SP.SOCRMODE命令で受信データサイズを設定することで、受信するデータ量を抑えることができる。

### 図
1. CPUユニット内の受信データ格納構造
- (d1)+0に受信データ長
- (d1)+1以降に受信データが格納される
- ソケット通信受信データエリアには、(s)で指定したコネクション番号が格納されている
- S.SOCRCVS命令で受信データを読み出す

2. S.SOCRCVS命令を使用した受信処理のタイミング（シーケンス図）
- オープン処理、データ受信処理、データ読出し処理の3段階に分かれる
- オープン完了信号(SD1504.n)がONになるとオープン処理開始
- シーケンススキャンのカウンタが0からENDまで動作
- ソケット通信受信状態信号(SD1506.n)がONになるとデータ受信開始
- S.SOCRCVS命令がONになると命令実行し、データ読出しを行う
- TCPの場合はACKを返す
- データ読出し後、信号はOFFになる

### 表
| エラーコード(SD0) | 内容 |
|-------------------|------|
| 2820H             | 受信したデータが受信データ格納先デバイスのデバイス/ラベルメモリの各設定エリアを超えるとき。 |
| 3405H             | (s)で指定するコネクション番号が1～16以外のとき。 |

</contents>