ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1113

<overview>
本ページは「選択リフレッシュ」命令(COM(P))に関する説明で構成されています。ページ全体は以下のセクションに分かれています。
- テキスト部分：命令の概要、実行条件、機能説明
- 表部分：命令の実行条件一覧、処理内容とSM775のON/OFF時の動作比較
- 図部分：ラダー図、FBD/LD図による命令の動作イメージ
</overview>

<contents>
### テキスト
#### 選択リフレッシュ COM(P)
COM(P)命令は、I/Oリフレッシュやネットワークユニットのリンクリフレッシュ、デバイス/ラベルアクセスサービス処理などを行う命令です。シーケンスプログラム実行途中の任意のタイミングで使用します。

##### 実行条件
- COM命令は立ち上がりエッジで実行
- COMP命令は立ち下がりエッジで実行

##### 機能
COM(P)命令を実行すると以下の処理を行います。
- I/Oリフレッシュ
- CC-Linkユニットのリンクリフレッシュ
- CC-Link IEコントローラネットワークユニットのリンクリフレッシュ
- CC-Link IEフィールドネットワークユニットのリンクリフレッシュ（シンプルモーションユニット(RD77GF)のリンクリフレッシュも含む）
- CC-Link IEフィールドネットワークBasicのリンクリフレッシュ
- MELSECNET/Hユニットのリンクリフレッシュ
- インテリジェント機能ユニットのリフレッシュ（シンプルモーションユニット(RD77GF)、モーションユニットのバックアップメモリリフレッシュ、RJ71GN11-EIP(EtherNet/IP部)のリフレッシュも含む）
- マルチCPUシステムのCPUバッファメモリを使用したリフレッシュ（END時）
- マルチCPUシステムのグループ外の入力/出力の取込み
- デバイス/ラベルアクセスサービス処理（エンジニアリングツール、GOTまたはその他の外部機器との交信）

SM775のCOM命令実行時にリフレッシュ処理選択をOFFにすると、I/Oリフレッシュを除く処理を行います。

### 図
- ラダー図：COM命令の基本的なラダー回路シンボルとST言語表記（ENO:=COM(EN); ENO:=COMP(EN);）
- FBD/LD図：COM命令のファンクションブロック図（EN入力、ENO出力）

### 表
#### 実行条件一覧
| 命令 | 実行条件 |
| :--- | :--- |
| COM | 立ち上がりエッジ |
| COMP | 立ち下がりエッジ |

#### 処理内容とSM775のON/OFF時の動作
| 処理内容 | SM775 OFF時 | SM775 ON時 |
| :--- | :--- | :--- |
| I/Oリフレッシュ、マルチCPUシステムのグループ外の入力/出力の取込み | 非実行 | 実行/非実行の選択が可能 |
| CC-Linkユニットのリンクリフレッシュ | 実行 | 実行 |
| CC-Link IEコントローラネットワークユニットのリンクリフレッシュ | 実行 | 実行 |
| CC-Link IEフィールドネットワークユニットのリンクリフレッシュ | 実行 | 実行 |
| CC-Link IEフィールドネットワークBasicのリンクリフレッシュ | 実行 | 実行 |
| MELSECNET/Hユニットのリンクリフレッシュ | 実行 | 実行 |
| インテリジェント機能ユニットのリフレッシュ | 実行 | 実行 |
| マルチCPUシステムのCPUバッファメモリを使用したリフレッシュ（END時） | 実行 | 実行 |
| デバイス/ラベルアクセスサービス処理（エンジニアリングツール、GOTまたはその他の外部機器との交信） | 実行 | 実行 |

注釈：
*1 シンプルモーションユニット(RD77GF)のリンクリフレッシュも含む。
*2 シンプルモーションユニット(RD77GF)、モーションユニットのバックアップメモリリフレッシュ、RJ71GN11-EIP(EtherNet/IP部)のリフレッシュも含む。
</contents>