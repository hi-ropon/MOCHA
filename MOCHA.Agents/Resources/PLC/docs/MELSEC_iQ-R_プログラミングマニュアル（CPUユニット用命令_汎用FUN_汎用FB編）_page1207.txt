ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1207

<overview>
このページは、ファイル転送機能用命令に関する説明の一部であり、主にワイルドカード指定の使い方やファイル名・拡張子の指定方法、転送可能ファイルの数やサイズの制限、転送時のエラー処理について記述されています。ページ構成は以下の通りです。
- テキスト部分：ワイルドカード指定のルール、ファイル名指定の注意点、転送可能ファイル数・サイズの計算式、転送時のエラー処理や動作仕様の詳細説明。
- 表部分：ワイルドカード指定の記号とその意味をまとめた表。
- 図部分：ファイルパスの区切り文字や指定可能な文字数を示す例示図。
</overview>

<contents>
### テキスト
#### ワイルドカード指定の使用方法
- (s2)で指定したファイル名または拡張子には、ワイルドカード「*」「?」を使用可能。
- 「*」は指定位置から任意の文字列（なしも含む）すべてのファイルを対象。
- 「?」は指定位置の任意の1文字（なしは含まない）を対象。複数使用可能。
- ピリオドはワイルドカード指定不可。
- ファイル名や拡張子に「*」と「?」を混在させたり、2個以上使うとエラー。

#### 転送可能ファイル数とサイズの制限
- 転送可能ファイル数は、指定された各ファイルのファイル名サイズの合計で決まる。
- 転送可能ファイル数の計算式：
  (Fi + NM) + 1 < 65536 [バイト]
  - N：ワイルドカード指定に一致するファイルの総数
  - Fi：ワイルドカード指定に一致するファイル名の合計サイズ
  - M：特定情報サイズ（固定6バイト）

#### 転送時のエラー処理
- SP.FTPGET命令実行中に1ファイル取得でエラー発生時は転送中止、残りのファイルは転送されない。
- 転送不可ファイルはワイルドカード条件に合致しても転送対象外。
- ファイル名・拡張子を含むファイルパスが255文字超の場合も転送対象外。

#### ファイル名指定の詳細
- (s2)にファイル名のみ指定時はFTPサーバのホームディレクトリ直下にアクセス。
- 区切り文字は「\」または「/」を使用。
- (s3)にはCPUユニットの転送先フォルダパスをUnicode文字列で指定。
- フォルダパスの区切り文字は半角の「\」または「/」。
- フォルダパス長は最大247文字（末尾区切り文字含む）で、ファイル名部分と合わせ最大255文字まで。
- 末尾区切り文字は省略可能、省略時は「\」が設定されているとみなす。
- 存在しないフォルダパスは命令実行時に自動作成される。

#### その他仕様
- 転送先に同名ファイルがある場合は上書きされる。
- 取得可能ファイルサイズは1ファイル最大4GB。
- SP.FTPGET命令の完了は完了デバイス(d)と状態表示デバイス(d)+1で確認可能。
- 正常完了時はOFFのまま、異常完了時はエラーコードを完了ステータスに格納。

### 表
| 記号 | 内容 |
| :--- | :--- |
| * | 「*」を指定した位置から任意の文字列（なしも含む）のすべてのファイルを対象にする。 |
| ? | 「?」を指定した位置が任意の文字（なしは含まない）のすべてのファイルを対象にする。（複数使用可） |

### 図
- ファイルパス例：「2:\database1\recipe\」
- 最大247文字まで指定可能（末尾の区切り文字含む）
- (1) 指定可能なドライブNo.は2または4（R00CPUは4のみ）
- (2) ドライブNo.の区切り文字は「:」または「/」
- (3) フォルダパスの区切り文字は半角の「\」または「/」
- (4) 末尾の区切り文字は省略可能

以上の内容により、ファイル転送命令におけるファイル名指定のルールや制限、転送時の動作仕様が詳細に説明されています。
</contents>