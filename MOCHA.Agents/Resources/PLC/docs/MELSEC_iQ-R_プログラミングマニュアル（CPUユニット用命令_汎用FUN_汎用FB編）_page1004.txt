ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1004

<overview>
このページは「特殊カウンタ命令」に関する説明で構成されています。主にテキスト部分で機能の詳細や動作条件、注意点が記載されており、例として回路図とタイミングチャートの図が含まれています。表はなく、図は回路構成と信号の時間変化を示すグラフで、カウント動作の流れを視覚的に説明しています。
</overview>

<contents>
### テキスト
#### 機能
- (s1)で指定された入力（A相パルス）と、(s1)+1で指定された入力（B相パルス）の状態により、(d)で指定されたカウンタの現在値を更新する。
- カウント方向は以下の通り。
  - (s1)がON時に(s1)+1がOFF→ONの場合はアップカウント（現在値を増加方向にカウント）
  - (s1)がON時に(s1)+1がON→OFFの場合はダウンカウント（現在値を減少方向にカウント）
  - (s1)がOFF時はカウントしない。
- カウント処理の詳細
  - アップカウント中に現在値が(s2)で指定された設定値と等しくなると、(d)で指定されたカウンタの接点がONになる。ただし、(d)で指定されたカウンタの接点がONしてもカウントは継続。
  - ダウンカウント中に現在値が設定値-1のとき、(d)で指定されたカウンタの接点がOFFになる。
  - (d)で指定されたカウンタはリングカウンタで、32760のときアップカウントすると-32768に戻り、32768のときダウンカウントすると32767になる。

#### 例
- X20がONしてからのX0、X1の状態をC0（アップ/ダウンカウンタ）によりカウントするプログラム例を示す。
- UDCNT2命令によるカウント処理は、実行指令のOFF→ON時にカウント開始、ON→OFF時にカウント停止。
- 再度OFF→ONすると中止時の現在値からカウント再開。
- (d)で指定されたカウンタの現在値クリアおよび接点OFFはRST命令で実行。

#### Point
- UDCNT2命令は引数のデバイスデータをCPUユニットのワークエリアに登録し、実際のカウント動作はシステム割込みで処理。割込み間隔は1ms以上必要。
- カウント中は設定値変更不可。変更する場合は実行指令をOFFにしてから行う。
- 指定カウンタは他命令と併用不可。併用すると正常カウント不可。
- UDCNT2命令は全プログラムで5回まで使用可能。6回目以降は無処理。

### 図
- 回路図：X20のONでUDCNT2命令が動作し、X0、X1の状態をC0カウンタにカウントする構成を示す。
- タイミングチャート：
  - X20、X0、X1の信号波形を示し、(1)がC0の現在値、(2)がC0の接点状態を時間軸で表現。
  - アップカウント時はカウント値が増加し、ダウンカウント時は減少する動作を矢印と数値で示している。

### エラー
- 演算エラーはなしと明記。
</contents>