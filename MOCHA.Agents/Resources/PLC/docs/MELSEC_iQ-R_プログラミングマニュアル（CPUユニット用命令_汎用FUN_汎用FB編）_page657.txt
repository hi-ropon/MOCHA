ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page657

<overview>
このページは「CSV形式変換書込み時」の動作説明に関する内容で構成されています。  
テキスト部分では、CSVファイルの拡張子、省略時の扱い、既存ファイルの指定時の動作、ファイルの新規作成時の属性設定、追加保存時のエラー処理、指定列数が0の場合の動作について説明しています。  
表や図はなく、代わりにラダー図のような命令例と、その命令に対応したデータの流れを示す図があり、Excelに書き出されたデータのイメージも掲載されています。  
全体として、CSV形式でのファイル書込み動作の具体的な動作例とその結果イメージを示す構成です。
</overview>

<contents>
### テキスト
#### CSV形式変換書込み時の動作説明
- 拡張子を省略した場合は「.CSV」となる。
- 既存ファイルが指定された場合の動作は以下の通り：
  - (d1)+4、(d1)+5でFFFFFFFFH以外を設定すると、ファイル内容をすべて削除し先頭からデータを保存。
  - (d1)+4、(d1)+5でFFFFFFFFHを設定すると、ファイルの最後からデータを保存。ただし、(d1)+3で1を指定した場合は、ファイルの最後の改行コードをカンマに変換しデータを保存。改行コード以外の場合はカンマへの変換は行わず、ファイルの最後からデータを保存。
- 既存しないファイルが指定された場合は新規作成し、先頭からデータを追加保存。このとき新規ファイルの属性はアーカイブ属性に設定される。
- データ追加保存中に空きエリアがなくなるとエラーとなり、追加保存可能な部分まで保存した後にエラー終了。
- 指定列数が0の場合は、1行のCSV形式ファイルとして保存。

### 図解説明
#### 例：CSV形式変換書込み時に指定列数が0の場合
- ラダー命令例として、SP.FWRITE命令が示されている。
- 各デバイス（D10～D17、D99～D106）に設定される値の意味が示されている。
  - D10: 実行/完了タイプ（0100H）
  - D11: 完了ステータス（未設定）
  - D12: 書込み結果データ数（K0）
  - D13: 未使用
  - D14～D17: ファイル位置、列数指定、データタイプ指定（すべてK0）
  - D99: 要求書込みデータ数（K7）
  - D100～D106: 書込みデータ（K0、K10、K20、K30、K40、K-50、K100）
- 書込みデータは「0,10,20,30,40,-50,100」の数値がカンマ区切りでファイルに書き込まれる。
- 書き込まれたデータはExcelの1行目のセルA～Gにそれぞれ対応し、数値が入力されている。
- 注記として、
  1. ワード単位指定であること。
  2. 正常完了すると書込みデータ数と同じになることが記載されている。

このページは、CSV形式でのファイル書込み命令の具体的な設定例と、その結果ファイルに書き込まれるデータのイメージを示し、動作の理解を助ける内容となっています。
</contents>