ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page823

<overview>
本ページは「文字列処理命令」に関する説明で構成されています。ページ全体は以下の3つのセクションに分かれています。
1. テキスト部分：シフトJIS文字列をUnicode文字列に変換し格納する機能の説明、具体的な指定方法や注意点の解説。
2. 図（フローチャートとデータ例）：シフトJIS→Unicode変換の動作例を示す命令の流れとメモリ配置のビット構成を図示。
3. 表部分：エラーコード一覧とそれぞれの内容説明。
</overview>

<contents>
### テキスト
#### 機能
- (s)で指定したシフトJIS文字列をUnicode文字列に変換し、(d)へ格納する。
- (s)のシフトJIS文字列はビッグエンディアンで指定する必要がある。

##### 例1：シフトJIS文字列の指定方法
- 文字列「95B6H」は「B695H」と指定する。
- ビット配置はb15～b8がB6H、b7～b0が95Hとなる。

##### 例2：Unicode文字列の指定方法
- Unicode文字列「6587H」は「6587H」と指定。
- Unicode文字列はリトルエンディアンで格納される。

- SJIS2WS(P)命令では(d)の先頭にバイトオーダーマークを付加しない。付加したい場合はSJIS2WSB(P)命令を使用する。
- シフトJIS→Unicode変換の動作は下記の図で示す。

### 図（命令動作例とデータ配置）
- SM402レジスタに「文字列123」をMOVP命令で格納し、M0がONのときにSJIS2WSP命令でD0のシフトJIS文字列をD100にUnicode文字列として変換。
- (s)側のD0～D4にはシフトJISコード（ビッグエンディアン）で文字列が格納されている。
- (d)側のD100～D106にはUnicodeコード（リトルエンディアン）で変換後の文字列が格納されている。
- 具体的な16進数コードのビット配置も示されている。

### 表（エラーコード）
| エラーコード(SD0) | 内容 |
|-------------------|------|
| 2821H             | (s)、(d)で指定した範囲が重複している場合。 |
| 3401H             | (s)で指定した範囲に変換できない文字コードが含まれている場合。 |
| 3405H             | (s)で指定した文字列が16,383文字を超える場合。<br>※漢字などシフトJISコードで2バイトデータになる文字は1文字あたり2とカウント。 |

</contents>