ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1002

<overview>
本ページは特殊カウンタ命令（UDCNT1命令）に関する説明で構成されています。ページ全体は主にテキスト部分で、機能説明、動作例、ポイント解説が中心です。図はカウンタの動作タイミングを示す波形図とラダー回路の簡単な例があり、表はありません。グラフはなく、図は動作の理解を助けるためのタイミングチャートと回路図です。
</overview>

<contents>
### テキスト
#### 機能
- (s1)で指定された入力のOFF→ON時に、(d)で指定されたカウンタの現在値を更新する。
- カウント方向は、(s1)+1で指定された入力のON/OFFにより決まる。
  - OFF: アップカウント（現在値を増加方向にカウント）
  - ON: ダウンカウント（現在値を減少方向にカウント）
- カウント処理の詳細：
  - アップカウント中に現在値が(s2)で指定された設定値と等しくなったとき、(d)で指定されたカウンタの接点がONになる。ただし、(d)で指定されたカウンタの接点がONでもカウントは継続。
  - ダウンカウント中に現在値が設定値-1のとき、(d)で指定されたカウンタの接点がOFFになる。
  - (d)で指定されたカウンタはリングカウンタで、現在値が327670のときアップカウントすると現在値は-32768になる。逆に現在値が-32768のときにダウンカウントすると現在値は32767になる。

#### 動作例
- X20がONしてからX0のOFF→ON回数をC0（アップ/ダウンカウンタ）でカウントするプログラム例と動作説明。
- ラダー回路例：X20がONのときUDCNT1命令が動作し、X0のOFF→ON回数をC0にカウント。
- タイミングチャートでX0のパルス、X1のアップ/ダウン信号、C0の現在値と接点の状態を示す。
- UDCNT1命令は実行指令のOFF→ON時にカウント開始、ON→OFF時にカウント中止。再度OFF→ONで中止時の現在値からカウント再開。
- カウンタの現在値クリアおよび接点OFFはRST命令で実行。

#### Point
- UDCNT1命令は引数のデバイスデータをCPUユニットのワークエリアに登録し、カウント動作はシステム割込みで処理される。
- CPUユニットの割込み間隔は1msで、カウントできるパルスはON/OFF時間が割込み間隔以上必要。
- カウント中は設定値の変更不可。変更時は実行指令をOFFにする必要あり。
- 指定カウンタは他命令で使用不可。複数命令で使用すると正常にカウントできなくなる。
- UDCNT1命令は全プログラムで6回まで使用可能。7回目以降は無処理。

### 図
- ラダー回路例：X20の接点がONのときUDCNT1命令が動作し、X0のOFF→ON回数をC0にカウント。
- タイミングチャート：
  - X0のパルス波形（ON/OFFの繰り返し）
  - X1のアップ/ダウン信号の変化（Up期間とDown期間）
  - C0の現在値の変化（0→5→4→1→0→1）
  - C0の接点状態（ON/OFFのタイミング）

### 表
なし

### エラー
- 演算エラーはなしと記載。
</contents>