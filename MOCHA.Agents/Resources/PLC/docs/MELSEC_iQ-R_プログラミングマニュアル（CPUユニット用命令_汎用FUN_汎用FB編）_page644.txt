ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page644

<overview>
本ページは、CSV形式のファイル読み出しに関する説明で構成されています。主にテキスト説明と、Excelデータの例を用いた表形式のデータ変換過程の図解が含まれています。テキスト部分では、指定列数が0以外の場合の動作説明があり、表部分ではExcelデータとCSVデータの対応関係、さらにデバイスに読み込まれるデータの構造が示されています。グラフやチャートはなく、図はデータの流れを示すフローチャート的な構成です。
</overview>

<contents>
### テキスト
- 指定列数が0以外の場合、指定された列数の表としてCSV形式のファイルを読み出すことができる。
- 指定列数を超える要素は無視される。

### 図・表の説明
#### 例：CSV形式変換読出し（10進数16ビットデータ）指定列数が0以外の場合((d1)+6が2の場合)
1. Excelで作成したデータ例
   - 「大／小項目」「測定値」という2列の表があり、長さ1に対して3、温度に対して-21の値が入力されている。

2. CSV形式で保存したデータ
   - Excel表の内容がカンマ区切りで保存されている。
   - 指定列数を超える要素は無視されるため、2列目以降の余分な要素は読み込まれない。

3. デバイスに読み込まれるデータの構造
   - SP.FREAD命令でファイルからデータを読み込み、U0、K2、D10、"ABCD"、D99、M0などのパラメータが設定されている。
   - (2)が読み込まれたデータ、(3)がファイル名、(4)がコントロールデータを示す。

4. コントロールデータの詳細
   - D10: 実行/完了タイプ（0100H）
   - D11: 完了ステータス（-）
   - D12: 要求読出しデータ数（K6）
   - D13: 最大読出しデータ数（K0）
   - D14, D15: ファイル位置（K0）
   - D16: 列数指定（K2）
   - D17: データタイプ指定（K0）

5. 読み込まれたデータの内容
   - D99: 読出し結果データ数（K6）
   - D100～D105: 各データの内容
     - D100「大／小項目」は数値以外のため変換データ0が格納される
     - D101「,」は数値以外のため変換データ0が格納される
     - D102「長さ」も数値以外のため変換データ0が格納される
     - D103「1」は数値でありバイナリ値に変換される（K1）
     - D104「温度」は数値以外のため変換データ0が格納される
     - D105「-21」は数値でありバイナリ値に変換される（K-21）

### ポイント
- CSVファイルの指定列数を超える要素は無視される。
- 数値以外のデータは変換データ0として格納される。
- 数値データはバイナリ値に変換されて格納される。
</contents>