ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1030

<overview>
本ページは「CPUユニット内蔵データベースアクセス機能」の一部で、「データベースアクセス命令」について説明しています。ページ構成は以下の通りです。
- テキスト部分：機能説明、注意事項、エラーに関する詳細な解説
- 図部分：DBEXPORT(P)命令の動作タイミングを示すタイムチャート
- 表部分：エラーコードとその内容をまとめた表
</overview>

<contents>
### テキスト
#### 機能
- (s)で指定したデータベースのフォルダパスに格納されているデータベースのデータをUnicodeテキストファイルに書き出す。
- Unicodeテキストファイルは、データベースフォルダが格納されているフォルダに作成され、ファイル名は「データベース名.txt」となる。既に存在する場合は上書きされる。
- 例として、フォルダパスが「2:\database\recipe1」の場合、Unicodeテキストファイル「2:\database\recipe1.txt」が作成され、データが書き出される。
- 正常完了すると、完了デバイス(d1)+0の完了信号がONになり、(d2)の完了ステータスに0が格納される。
- DBEXPORT(P)命令実行時の完了デバイスの動作をタイムチャートで示す。
- 書き出されるUnicodeテキストファイルの内部構成は、DBIMPORT(P)命令でインポートするファイルと同じ。
- 実行中はSM753（ファイルアクセス中）がONとなり、この間はDBEXPORT(P)命令は実行不可。異常完了する。
- CPUユニットのユニットパラメータで「内蔵データベースアクセス使用有無」を「使用する」に設定している場合、SM1498（内蔵データベース起動完了フラグ）がOFFの間はDBEXPORT(P)命令は実行不可。
- トランザクション中はDBEXPORT(P)命令は実行不可。

#### 注意事項
以下の場合、(d1)+1の異常完了信号がONになり、(d2)の完了ステータスにエラーコードが格納される。
- データベースアクセス命令実行中にDBEXPORT(P)命令を実行した場合
- (s)で指定したパスがデータベースでない場合
- データベースへのアクセスに失敗し、Unicodeテキストへの書き出しが失敗した場合
- (s)で指定したパスの文字数（ドライブパス文字含む）が128文字を超えた場合
- ファームウェアバージョンが28より前のシーケンサCPUで、(s)に28以降のファームウェアバージョンのシーケンサCPUで構築または操作したデータベースを指定した場合
- トランザクション中にDBEXPORT(P)命令を実行した場合

#### エラー
| エラーコード(SD0) | 内容                         |
|-------------------|------------------------------|
| 2840H             | (s)のドライブ番号で、2以外の数値を指定したとき。 |

オペランドの完了ステータスに格納されるエラーコードについては、1066ページの「データベースアクセス命令で発生するエラーコード」を参照。

### 図
- DBEXPORT(P)命令の動作タイミングを示すタイムチャート
  - プログラム開始後、DBEXPORT(P)命令が実行されると、完了デバイス(d1)と(d1)+1はOFF状態からONに変わる。
  - データベースへのエクスポート処理中は完了デバイス(d1)がONのまま維持される。
  - 正常完了時は(d1)+0の完了信号がONになり、(d1)+1はOFFに戻る。
  - 異常完了時は(d1)+1の完了信号がONになる。

### 表
#### エラーコード一覧
| エラーコード | 内容                                       |
|--------------|--------------------------------------------|
| 2840H        | (s)のドライブ番号で、2以外の数値を指定した場合。 |

</contents>