ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page658

<overview>
このページは「ファイル操作命令」に関する説明で構成されています。主にテキストと図（命令の構造とデータの流れを示すブロック図）、およびExcelに書き出されたデータの例が含まれています。テキスト部分では、CSV形式変換書込み時の指定列数が0以外の場合の動作について説明しています。図は命令の各パラメータの役割と、ファイルに書き込まれるデータの対応関係を示しています。最後に、Excelに書き出されたデータのイメージが示されています。
</overview>

<contents>
### テキスト
- 指定列数が0以外の場合、指定された列数の表としてCSV形式のファイルを保存します。
- 例として、CSV形式変換書込み時に指定列数が0以外の場合の動作を説明しています。

### 図の説明
- 命令「SP.FWRITE U0 K2 D10 "ABCDE" D99 M0」の構成を示しています。
- 各デバイスの役割は以下の通りです。
  - D10: 実行/完了タイプ（例：0100H）
  - D11: 完了ステータス（未使用の場合は「-」）
  - D12: 書込み結果データ数（例：K0）
  - D13: 未使用（「-」）
  - D14～D15: ファイル位置（例：K0）
  - D16: 列数指定（例：K3）
  - D17: データタイプ指定（例：K0）
  - D99: 要求書込みデータ数（例：K7）
  - D100～D106: 書込みデータ（例：K0、K10、K20、K30、K40、K-50、K100）

- 書込みデータはファイルに以下のように書き込まれます。
  - 0, 10, 20 (CR LF)
  - 30, 40, -50 (CR LF)
  - 100 (CR LF)

- 矢印で各デバイスの値がファイルのどの位置に書き込まれるかを示しています。

### Excelに書き出されたデータ
- 書き込まれたデータはExcelの表として以下のように表示されます。

|   | A  | B  | C  |
|---|----|----|----|
| 1 | 0  | 10 | 20 |
| 2 | 30 | 40 | -50|
| 3 |100 |    |    |

### 注釈
1. ワード単位指定とします。
2. 正常完了すると、書込みデータ数と同じになります。
</contents>