ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1032

<overview>
本ページは「CPUユニット内蔵データベースアクセス機能」の一部で、特に「データベースアクセス命令(DBOPEN(P)命令)」に関する説明で構成されています。ページ全体は以下のセクションで構成されています。
- テキスト部分：機能説明、注意事項、エラーコードの説明
- 図部分：DBOPEN(P)命令実行時の完了デバイスの動作を示すタイミングチャート
- 表部分：エラーコードとその内容の一覧表
グラフ部分はありません。
</overview>

<contents>
### テキスト
#### 機能
- (s)で指定したフォルダパスに格納されているデータベースに接続し、データベースを使用可能な状態にします。
- 格納先は「(ドライブ番号):(データベースフォルダのパス)」で指定し、ドライブ番号は2（SDメモリカード）固定です。
- 正常に完了すると、接続したデータベースの識別番号を(d1)に格納し、完了デバイス(d2)+0の完了信号がONになり、(d3)の完了ステータスに0が格納されます。
- DBOPEN(P)命令実行時の完了デバイスの動作は図の通りです。

- DBOPEN(P)命令では異なるデータベースに対して同時に4個まで接続可能。
- トランザクション中は新たにデータベースをオープンできません。
- DBOPEN(P)命令実行中はSM753（ファイルアクセス中）がONとなり、ON中はDBOPEN(P)命令は実行不可。実行した場合は無処理。ただし、データベースアクセス命令実行中は異常完了となる。
- CPUユニットのユニットパラメータで「内蔵データベースアクセス使用有無」を「使用する」に設定し、SM1498（CPUユニット内蔵データベース起動完了フラグ）がOFFの間はDBOPEN(P)命令は実行不可。実行した場合は無処理。

#### 注意事項
以下の場合、(d2)+1の異常完了信号がONになり、(d3)の完了ステータスにエラーコードが格納される。
- データベースアクセス命令実行中にDBOPEN(P)命令を実行した場合
- (s)で指定した格納場所が存在しない場合
- すでに接続済みのデータベースに対して再度接続しようとした場合
- 同時に接続可能なデータベース数を超えてDBOPEN(P)命令を実行した場合
- (s)で指定したパスの文字数（ドライブパス文字含む）が128文字を超えた場合
- トランザクション中にデータベースをオープンした場合

### 図
- DBOPEN(P)命令実行時の完了デバイスの動作を示すタイミングチャート
  - プログラムの実行に合わせてDBOPEN(P)命令が発行されると、完了デバイス(d2)と(d2)+1がOFFからONに変わるタイミングが示されている。
  - 「データベースオープン」処理中は完了デバイス(d2)がONとなり、異常完了時は(d2)+1がONになる。
  - END処理のタイミングも示されている。

### 表
#### エラーコード（SD0）
| エラーコード | 内容 |
| :----------- | :--- |
| 2820H        | (d2)で指定した範囲が、該当デバイス/ラベルを超える場合。 |
| 2840H        | (s)のドライブ番号で、2以外の数値を指定したとき。 |

- オペランドの完了ステータスに格納されるエラーコードの詳細は1066ページの「データベースアクセス命令で発生するエラーコード」を参照するよう案内がある。
</contents>