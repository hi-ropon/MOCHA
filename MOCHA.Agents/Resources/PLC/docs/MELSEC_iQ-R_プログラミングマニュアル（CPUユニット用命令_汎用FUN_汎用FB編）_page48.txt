ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page48

<overview>
本ページは主にテキストと表で構成されており、文字列データのワードデバイスへの格納に関する説明が中心です。具体的には、文字列データを格納するために必要なワード数の計算方法、文字列データの格納先イメージについて、通常の文字列とUnicode文字列の場合に分けて解説しています。グラフや図はなく、表を用いて具体的なデータ配置例を示しています。
</overview>

<contents>
### テキスト
#### データ格納に必要なワード数
文字列データはワードデバイスに格納可能であり、格納に必要なワード数は文字列のバイト数に応じて異なります。

- 0バイトの場合：1ワード必要
- 奇数バイトの場合：文字列のバイト数＋1をワード数とする（Unicode文字列の場合は1文字が偶数バイトのため例外）
- 偶数バイトの場合：文字列のバイト数＋2をワード数とする（Unicode文字列は文字数＋1ワード）

#### 文字列データの格納先
文字列データの格納先イメージを示し、NULLはNULLコード（00H）で表されます。

##### ■文字列の場合
- 空文字列（""または' '）はD0にNULLが2つ並ぶ形で格納されます。
- 文字列"ABC"はD0にB、A、D1にNULL、Cが格納されます。
- 文字列"ABCD"はD0にB、A、D1にD、C、D2にNULLが2つ並ぶ形で格納されます。

ワード型ラベルの配列arrayAの場合も同様の配置で、空文字列はarrayA[0]にNULLが2つ、"ABC"はarrayA[0]にB、A、arrayA[1]にNULL、C、"ABCD"はarrayA[0]にB、A、arrayA[1]にD、C、arrayA[2]にNULLが2つ並びます。

##### ■Unicode文字列の場合
Unicode文字列の格納イメージではNULLはNULLコード（0000H）で示されます。

- 空文字列（""）はD0にNULLが格納されます。
- 文字列"ABCD"はD0からD4までにそれぞれA、B、C、D、NULLが1つずつ格納されます。

ワード型ラベルの配列arrayAの場合も同様で、arrayA[0]にNULL、"ABCD"はarrayA[0]からarrayA[4]にA、B、C、D、NULLが順に格納されます。

### 表
#### 文字列のバイト数と必要ワード数

| 文字列のバイト数 | 文字列を格納するために必要なワード数 | Unicode文字列を格納するために必要なワード数 |
| :--------------- | :---------------------------------- | :----------------------------------------- |
| 0バイト          | 1[ワード]                          | 1[ワード]                                  |
| 奇数バイト        | (文字列のバイト数)+1[ワード]       | —（1文字が偶数バイトのため）                 |
| 偶数バイト        | (文字列のバイト数)+2[ワード]       | 文字数+1[ワード]                           |

#### 文字列の格納イメージ（通常文字列）

| 格納する文字列 | D0から文字列データを格納したときのイメージ | ワード型ラベルの配列arrayA[0]から文字列データを格納したときのイメージ |
| :------------- | :--------------------------------------- | :----------------------------------------------------------------- |
| 空文字列       | D0: NULL NULL                            | arrayA[0]: NULL NULL                                               |
| ABC            | D0: B A<br>D1: NULL C                    | arrayA[0]: B A<br>arrayA[1]: NULL C                               |
| ABCD           | D0: B A<br>D1: D C<br>D2: NULL NULL     | arrayA[0]: B A<br>arrayA[1]: D C<br>arrayA[2]: NULL NULL          |

#### 文字列の格納イメージ（Unicode文字列）

| 格納する文字列 | D0から文字列データを格納したときのイメージ | ワード型ラベルの配列arrayA[0]から文字列データを格納したときのイメージ |
| :------------- | :--------------------------------------- | :----------------------------------------------------------------- |
| 空文字列       | D0: NULL                                | arrayA[0]: NULL                                                   |
| ABCD           | D0: A<br>D1: B<br>D2: C<br>D3: D<br>D4: NULL | arrayA[0]: A<br>arrayA[1]: B<br>arrayA[2]: C<br>arrayA[3]: D<br>arrayA[4]: NULL |

</contents>