ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1212

<overview>
本ページはPID演算命令に関する説明で構成されています。ページ全体は以下のセクションに分かれています。
- テキスト部分：PID演算命令の概要説明、演算式の説明、記号の意味の解説
- 表部分：演算式中の記号とその意味を一覧化した表
- グラフ部分はなし
</overview>

<contents>
### テキスト
#### PID演算命令の基本演算式[参考]
本命令は速度形・測定値微分形の演算式によりPID演算を行います。
(s3)+1(動作設定(ACT))のビット0の内容によって、正動作または逆動作の演算式が実行されます。
演算に必要とされている各値は、(s3)以降に指定した制御用データの内容で演算します。

##### 演算式
- 正動作(OFF)の場合：
  \[
  \Delta MV = K_P \{ (EV_n - EV_{n-1}) + \frac{T_S}{T_I} EV_n + D_n \}
  \]
  \[
  EV_n = PV_{nf} - SV
  \]
  \[
  D_n = \frac{T_D}{T_S + K_D \cdot T_D} \left( -2PV_{nf-1} + PV_{nf} + PV_{nf-2} \right) + \frac{K_D \cdot T_D}{T_S + K_D \cdot T_D} \cdot D_{n-1}
  \]
  \[
  MV_n = \sum \Delta MV
  \]

- 逆動作(ON)の場合：
  \[
  \Delta MV = K_P \{ (EV_n - EV_{n-1}) + \frac{T_S}{T_I} EV_n + D_n \}
  \]
  \[
  EV_n = SV - PV_{nf}
  \]
  \[
  D_n = \frac{T_D}{T_S + K_D \cdot T_D} \left( 2PV_{nf-1} - PV_{nf} - PV_{nf-2} \right) + \frac{K_D \cdot T_D}{T_S + K_D \cdot T_D} \cdot D_{n-1}
  \]
  \[
  MV_n = \sum \Delta MV
  \]

##### 演算式中の記号の意味
| 記号 | 意味 |
| --- | --- |
| EV_n | 今回のサンプル時の偏差 |
| EV_{n-1} | 1周期前の偏差 |
| SV | 目標値 |
| PV_{nf} | 今回のサンプル時の測定値（フィルタ後） |
| PV_{nf-1} | 1周期前の測定値（フィルタ後） |
| PV_{nf-2} | 2周期前の測定値（フィルタ後） |
| ΔMV | 出力変化量 |
| MV_n | 今回の操作量 |
| D_n | 今回の微分項 |
| D_{n-1} | 1周期前の微分項 |
| K_P | 比例ゲイン |
| T_S | サンプリング周期 |
| T_I | 積分定数 |
| T_D | 微分定数 |
| K_D | 微分ゲイン |

今回のサンプル時の測定値（フィルタ後）PV_nfは、読み込んだ測定値を下式で演算した値です。入力データのフィルタ係数が設定されていない場合は、入力データの測定値(PV)と同一の値となります。

\[
PV_{nf} = PV_n + L (PV_{nf-1} - PV_n)
\]

ここで、PV_nfは今回のサンプル時の測定値、Lはフィルタ係数、PV_{nf-1}は1周期前の測定値（フィルタ後）です。
</contents>