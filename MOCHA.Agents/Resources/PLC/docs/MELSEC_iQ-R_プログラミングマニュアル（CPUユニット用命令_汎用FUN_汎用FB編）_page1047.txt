ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1047

<overview>
本ページは、CPUユニット内蔵データベースアクセス機能の「DBUPDATE(P)命令」実行時の完了デバイスの動作説明、注意事項、及びエラーコードについて構成されています。ページ全体は以下のセクションで構成されています。
・テキスト部分：DBUPDATE(P)命令の動作説明、注意事項の詳細記述
・図部分：DBUPDATE(P)命令実行時の完了デバイスの動作タイミングを示すタイムチャート
・表部分：エラーコードとその内容をまとめた表
グラフ部分はありません。
</overview>

<contents>
### テキスト
#### DBUPDATE(P)命令実行時の完了デバイスの動作
DBUPDATE(P)命令実行時の完了デバイスの動作は、図のタイムチャートの通りです。命令実行中はSM753（ファイルアクセス中）がONとなり、この間はDBUPDATE(P)命令は実行できません。実行した場合は無処理となります。ただし、データベースアクセス命令実行中の場合は異常完了します。

CPUユニットのユニットパラメータで「内蔵データベースアクセス使用有無」を“使用する”に設定している場合、SM1498（CPUユニット内蔵データベース起動完了フラグ）がOFFの間はDBUPDATE(P)命令は実行できず、実行しても無処理となります。

#### 注意事項
以下の場合、完了デバイス(d1)+1の異常完了信号がONとなり、(d2)の完了ステータスにエラーコードが格納されます。
- データベースアクセス命令実行中にDBUPDATE(P)命令を実行した場合
- (s1)で範囲外の識別番号を指定した場合
- (s1)で未オープンの識別番号を指定した場合
- ファームウェアバージョンが“28”より前のシーケンサCPUで、(s1)にファームウェアバージョンが“28”以降のシーケンサCPUで構築または操作したデータベースを指定した場合
- (s2)で指定したテーブル名が存在しない場合
- (s2)で指定したテーブル名の文字数が32文字を超える場合
- (s3)で更新するフィールド数を範囲外の値に設定した場合
- (s3)+1～(s3)+回で指定したフィールド名に範囲外のフィールド名を設定した場合
- (s5)で条件サイズを範囲外の値に設定した場合
- (s5)の1個目の条件サイズを0に設定した場合
- (s5)で条件符号を範囲外の値に設定した場合
- (s5)で条件間演算値を範囲外の値に設定した場合
- データベースのUPDATE処理に失敗した場合
- (s5)+35で指定する条件間演算値が1または2で、(s5)+1で0を設定している場合
- (s4)+2で設定する1レコード分のデータの範囲が、(s4)で指定したサイズと一致していない場合
- (s5)+2で設定するフィールド名が未設定の場合

### 図
#### DBUPDATE(P)命令実行時の完了デバイス動作タイムチャート
- プログラムのDBUPDATE(P)命令実行開始からEND処理までの時間軸を示す。
- 完了デバイス(d1)は命令実行開始時はOFF、END処理時にONとなり、その後OFFに戻る。
- 完了デバイス(d1)+1は異常完了時にONとなり、END処理後にOFFに戻る。
- 命令実行中にデータベースのデータ更新が行われるタイミングが示されている。

### 表
#### エラーコード一覧
| エラーコード (SD0) | 内容 |
|--------------------|------|
| 2820H              | (s2)、(s3)、(s4)、(s5)、(d1)で指定した範囲が該当デバイス/ラベルを超える場合 |

オペランドの完了ステータスに格納されるエラーコードについては、1066ページの「データベースアクセス命令で発生するエラーコード」も参照するよう案内がある。
</contents>