ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page640

<overview>
このページは「CSV形式変換読出し時」のデータ処理に関する説明で構成されています。ページ全体は主にテキスト説明と表で構成されており、CSVファイルの読み込みルールやエラー条件、ファイルの扱い方について詳細に記述されています。表はCSV内のデータ型ごとに、CSV内のデータ範囲とデバイス格納値の対応関係を示しています。グラフや図は含まれていません。
</overview>

<contents>
### テキスト
#### CSV形式変換読出し時の概要
- CSV形式のファイルの要素（Excelのセル）を行方向に順に読み出し、デバイスに格納する。
- 対象ファイルの拡張子を省略した場合は「.CSV」となる。
- 存在しないファイル指定はエラーとなる。
- ファイルの先頭から要求読出しデータ数(1)+2で指定された分のデータを読み込む。
- 指定列数が0の場合はCSVファイルの行区切りを無視して読み出す。
- CSV内の文字列データと読出し後のデバイス格納値は実行/完了タイプにより決定される。

### 表
#### 実行/完了タイプ別CSV内データとデバイス格納値の対応

| 実行/完了タイプ | CSV内データ(1要素) | デバイス格納値 | 備考 |
|-----------------|--------------------|----------------|------|
| 0100H: 10進数(16ビットデータ) | -32768～1<br>0～32767<br>32768～65535<br>・上記以外の数値<br>・アルファベットや記号を含む文字列 | -32768～-1 (32768～65535)<br>0～32767<br>-32768～-1 (32768～65535)<br>0 | 符号付き16ビットデータとして扱う場合は-32768～-1、符号なし16ビットデータとして扱う場合は32768～65535となる。変換できないものは0格納。 |
| 0110H: 10進数(32ビットデータ) | -2147483648～-1<br>0～2147483647<br>2147483648～4294967295<br>・上記以外の数値<br>・アルファベットや記号を含む文字列 | -2147483648～-1 (2147483648～4294967295)<br>0～2147483647<br>-2147483648～-1 (2147483648～4294967295)<br>0 | 符号付き32ビットデータとして扱う場合は-2147483648～-1、符号なし32ビットデータとして扱う場合は2147483648～4294967295となる。変換できないものは0格納。 |
| 0120H: 16進数(16ビットデータ) | 0H～FFFFH<br>・上記以外の数値<br>・A～F以外のアルファベットや記号を含む文字列 | 0H～FFFFH<br>0000H | 変換できないものは0格納。 |
| 0121H: 16進数(32ビットデータ) | 0H～FFFFFFFFH<br>・上記以外の数値<br>・A～F以外のアルファベットや記号を含む文字列 | 0H～FFFFFFFFH<br>00000000H | 変換できないものは0格納。 |
| 0130H: 文字列(アスキーデータ) | 文字列(1999文字まで)<br>文字列(2000文字以上) | 文字列(1999文字まで) | 末尾にNULL(00H)が追加される。CSV内の文字列が偶数バイトの場合、次の1ワード分に0000Hが格納される。2000文字以上は1999文字まで読み出し。 |
| 0140H: 浮動小数点実数(単精度実数) | -2^128＜データ≤-2^-126、0、2^-126＜データ＜2^128の範囲の値<br>上記以外の数値 | 左記範囲の値<br>0 | 小数点形式/指数形式のいずれの形式でも変換される。変換できないものは0格納。 |
| 0141H: 浮動小数点実数(倍精度実数) | -2^1024＜データ≤-2^-1022、0、2^-1022＜データ＜2^1024の範囲の値<br>上記以外の数値 | 左記範囲の値<br>0 | 小数点形式/指数形式のいずれの形式でも変換される。変換できないものは0格納。 |

</contents>