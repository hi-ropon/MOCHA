ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page663

<overview>
このページは主にテキストと表で構成されています。テキスト部分では、実行/完了タイプ(d1)+0に「0140H:浮動小数点実数(単精度実数)」または「0141H:浮動小数点実数(倍精度実数)」を設定した場合のCSVファイルへの書き込み内容について説明しています。続いて、SDメモリカードにCSV形式のファイルを書き込む際のファイルサイズ（合計バイト数）の算出方法を詳細に解説しています。表は、データ値の符号ごとのバイト数の計算方法と具体例を示しています。ページ下部には注意事項として、SP.FWRITE命令の使用上の注意が記載されています。
</overview>

<contents>
### テキスト
#### 実行/完了タイプ(d1)+0に「0140H」または「0141H」を設定した場合のCSVファイル書き込み内容
- 「0140H:浮動小数点実数(単精度実数)」の場合、書き込みデータは-2^128 < データ ≤ 2^-126、0、2^-126 < データ < 2^128の範囲の値であり、CSVファイルには小数部桁数0～7の指数形式で書き込まれます。範囲外の値は変換できず0が書き込まれます。
- 「0141H:浮動小数点実数(倍精度実数)」の場合、書き込みデータは-2^1024 < データ ≤ 2^-1022、0、2^-1022 < データ < 2^1024の範囲の値であり、CSVファイルには小数部桁数0～15の指数形式で書き込まれます。範囲外の値は変換できず0が書き込まれます。

#### SDメモリカードにCSV形式ファイルを書き込む際のファイルサイズ算出方法
- ファイルサイズ（合計バイト数）＝[最終行以外の合計バイト数]＋[最終行のバイト数]
- 各行のバイト数＝[列数]*2 + 1 + [行内の各データ値のバイト数の合計]
- 最終行以外は指定した列数となるが、最終行は書き込みデータ数により列数が異なる場合があるため、最終行の行数・列数を別途算出する必要がある。
- 最終行の行数は「最終行を除いた行数＝要求書き込みデータ数÷列数（余りは切捨て）」で計算。
- 最終行の列数は「最終行の列数＝要求書き込みデータ数－（最終行を除いた行数×列数）」で計算。
- 各データ値のバイト数は下記表の通り。

### 表
| データ値の符号 | 各データ値のバイト数 | バイト数の範囲 | 例 |
| --- | --- | --- | --- |
| 正 | 桁数 | 1～5（ワード指定時）1～3（バイト指定時） | 12345→5バイト、67→2バイト |
| 負 | 桁数＋1 | 2～6（ワード指定時）2～4（バイト指定時） | -12345→6バイト、-67→3バイト |

### 注意事項
- SP.FWRITE命令は割込みプログラムで実行しないこと。割込みプログラムで実行すると誤動作の原因となる。
- SP.FWRITE命令はファイル書き込みが発生するため、命令実行時にスキャンタイムが延びることがある。
</contents>