ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page594

<overview>
このページは、プログラム制御における「EFCALL命令」の使用例と動作説明で構成されています。ページ全体は以下の3つのセクションに分かれています。
1. テキスト部分：EFCALL命令の使用条件や注意点、ファイル名の指定方法、サブルーチンプログラムのファンクションデバイス対応についての説明。
2. 表部分：特に表形式はありませんが、箇条書きでポイントが整理されています。
3. 図・グラフ部分：EFCALL命令を使用しない場合のラダー図、タイミングチャート、EFCALLP命令を使った場合のラダー図が掲載されており、命令の動作やデバイスの転送関係を視覚的に示しています。
</overview>

<contents>
### テキスト
#### EFCALL命令を使用しない場合の動作例
- ファイル名はプログラムメモリに格納されているプログラムファイルのみ指定可能。
- ファイル名に拡張子(.PRG)を指定する必要はなく、.PRGファイルのみ対象。
- サブルーチンプログラムでファンクションデバイス(FX、FY、FD)を使用する場合、(s1)～(s5)で対応するデバイスを指定。
- サブルーチンプログラム実行前に、ビットデータはFXに、ワードデータはFDに転送される。
- 実行後はFY、FDの内容が対応するデバイスに転送される。
- FX、FYのファンクションデバイスの処理単位はビット単位、FDは4ワード単位。
- 指定デバイスの種類によりデータサイズが異なり、ファンクションデバイスで指定されたデバイスはデータサイズ分確保が必要。確保できない場合はエラー。

### 図・グラフ
#### ラダー図（EFCALL命令を使用しない場合）
- X0がONのとき、ECALL命令で"ABC"プログラムのP0を呼び出す。
- 呼び出されたプログラム[ABC.PRG]では、P0の条件でX1がONならY10を出力し、Y11をセット、M0にパルスを出す。
- プログラム終了後にRET、ENDで戻る。

#### タイミングチャート
- X0、X1の入力信号のON/OFFに応じて、Y10、Y11、M0の出力が変化する様子を示す。
- Y10はX1のONに連動し、Y11はセットされて保持、M0はパルス的にONになる。

#### ラダー図（EFCALLP命令を使用した場合）
- メインプログラム[MAIN]でX10がONのとき、EFCALLP命令で"ABC"のP0を呼び出す。
- 呼び出し時にX0、D0、D100のデバイスがファンクションデバイスとして渡される。
- サブルーチンプログラム[ABC]のP0では、FX0がONのとき、D*、FD1、K100、FD2の処理を行い、FENDで終了しRETで戻る。
- 呼び出し元とサブルーチン間でビットデータやワードデータの転送が行われることを示している。

### 箇条書きポイント
- ファイル名はプログラムメモリ内のプログラムファイルのみ指定可能。
- 拡張子指定不要。
- サブルーチンプログラムのファンクションデバイス対応は(s1)～(s5)で指定。
- 実行前後にビットデータやワードデータの転送が行われる。
- ファンクションデバイスの処理単位はビット単位または4ワード単位。
- データサイズの確保が必須で、確保できない場合はエラーとなる。

</contents>