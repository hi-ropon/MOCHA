ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1116

<overview>
このページは「S(P).ZCOM命令」に関する説明で構成されています。ページ全体は以下のセクションで構成されています。
- テキスト部分：S(P).ZCOM命令の機能説明、注意事項、ポイントの解説。
- 図部分：S(P).ZCOM命令を使用した場合と使用しない場合のプログラムとリンクスキャンのタイミングを示すタイムチャートが2つと、プログラム全体のタイミングを示すタイムチャートが1つ。
- 表部分：エラーコード（SD0）とその内容をまとめた表。
</overview>

<contents>
### テキスト
#### 機能
S(P).ZCOM命令を実行すると、CPUユニットはシーケンスプログラムの処理を一時中断し、(J/U)で指定されたユニットのリフレッシュ処理を行います。  
CC-Link IEコントローラネットワークユニットおよびMELSECNET/Hユニット（PC間ネット）のリフレッシュ処理を行う場合は、S(P).ZCOM命令を使用します。これは、自局のシーケンスプログラムのスキャンタイムが他局のスキャンタイムより長い場合に、他局からのデータを確実に取り込むために使われます。

#### 注意事項
- S(P).ZCOM命令はプログラム中に何回でも使用可能ですが、リフレッシュ時間分だけプログラムのスキャンタイムが延びます。
- 実行中は割込み許可状態となり、割込みプログラムなどでリフレッシュデータを使用する場合はデータの泣き別れが発生することがあります。

#### Point
- S(P).ZCOM命令は割込みプログラムでは使用できません。
- 外部機器との交信のみを実行したい場合は、COM(P)命令を使用してください。

### 図
- 【S(P).ZCOM命令を使用しない場合】  
  管理局のプログラム、リンクスキャン、通常局のプログラムのタイミングを示すタイムチャート。管理局のプログラムがENDに達するとリンクスキャンが行われ、その後通常局のプログラムが実行される流れ。

- 【S(P).ZCOM命令を使用した場合】  
  同様のタイムチャートで、管理局のプログラムのENDのタイミングでZCOM命令が複数回実行され、リンクスキャンが割り込む形で行われていることを示す。

- 【プログラム全体のタイミング】  
  プログラムの中で複数回ZCOM命令が実行されている様子を示し、ENDまでの流れを視覚的に表現。

### 表
#### エラーコード（SD0）
| エラーコード | 内容 |
| :--- | :--- |
| 2800H | 指定した先頭入出力番号が0～FFH以外のとき。 |
| 2801H | 先頭入出力番号で指定した位置にユニットが存在しないとき。 |
| 2804H | 指定したネットワークNo.が1～239以外のとき。 |
| 2820H | 指定したネットワークNo.が自局に接続されていないとき。 |
</contents>