ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1473

<overview>
本ページは「39.3 文字列の抽出」についての説明で構成されています。ページ全体は以下のセクションに分かれています。
- テキスト部分：MID(_E)関数の概要、使用可能なCPUタイプ、機能説明、引数の説明、演算処理の説明。
- 図部分：ラダー、FBD/LD、ST言語での関数ブロックの構造図。
- 表部分：引数の内容、種別、データ型をまとめた表。
- 図部分（例示）：入力文字列と出力文字列のバイト構造を示す図解。
グラフ部分はありません。
</overview>

<contents>
### テキスト
#### 39.3 文字列の抽出 MID(_E)
MID(_E)関数は、入力された文字列の任意の位置から指定した文字数分の文字列を出力します。

対応CPUは、RnCPU、RnENCPU、RnPCPU（三重化・一般・安全）、RnSFCPU（一般・安全）となっています。

##### 使用言語別関数ブロック
- ラダー、FBD/LDでは、EN/ENO付き・なしの2種類のブロックが用意されています。
- ST言語では、EN/ENOなしの場合は d:=MID(s,n1,n2);、EN/ENO付きの場合は d:=MID_E(EN,ENO,s,n1,n2); と記述します。

#### 設定データ
| 引数 | 内容 | 種別 | データ型 |
| :--- | :--- | :--- | :--- |
| EN | 実行条件(TRUE:実行、FALSE:停止) | 入力変数 | BOOL |
| s(IN) | 入力文字列 | 入力変数 | ANYSTRING_SINGLE |
| n1(L) | 抽出文字数指定 | 入力変数 | INT |
| n2(P) | 抽出先頭位置指定 | 入力変数 | INT |
| ENO | 出力状態(TRUE:正常、FALSE:異常) | 出力変数 | BOOL |
| d | 出力文字列 | 出力変数 | ANYSTRING_SINGLE |

#### 機能
- (s)に入力された文字列の任意位置から指定文字数分のデータを(d)から出力します。
- 抽出する文字数は(n1)への入力値で指定します（1以上）。
- 抽出先頭位置は(n2)への入力値で指定します。

#### 演算処理の例
(n1)、(n2)への入力値が5の場合の例を示しています。

入力文字列 (s): "ABCDEF12345" の中から、5文字分を5文字目から抽出し、出力文字列 (d): "EF123" となる動作を示しています。

図では、入力文字列の各バイト（上位バイト・下位バイト）と出力文字列のバイト配置を16進数で示し、抽出先頭位置(n2)と抽出文字数(n1)の関係を視覚的に説明しています。

#### 入力値の範囲
- (s)の入力値はSTRING型で0～255バイトの範囲内。
- (n1)の入力値はINT型で0～255の範囲内。ただし、(s)の文字列長以内に限る。
- (n2)の入力値はINT型で1～255の範囲内。ただし、(s)の文字列長以内に限る。

### 図
- ラダー、FBD/LDの関数ブロック図：EN/ENOなしはs, n1, n2を入力しdを出力。EN/ENO付きはEN, ENOも含む。
- ST言語の記述例。
- 入力文字列と出力文字列のバイト構造図：16進数で各バイトの値を示し、抽出開始位置と文字数を矢印で示している。

### 表
#### 設定データ（引数一覧）
| 引数 | 内容 | 種別 | データ型 |
| :--- | :--- | :--- | :--- |
| EN | 実行条件(TRUE:実行、FALSE:停止) | 入力変数 | BOOL |
| s(IN) | 入力文字列 | 入力変数 | ANYSTRING_SINGLE |
| n1(L) | 抽出文字数指定 | 入力変数 | INT |
| n2(P) | 抽出先頭位置指定 | 入力変数 | INT |
| ENO | 出力状態(TRUE:正常、FALSE:異常) | 出力変数 | BOOL |
| d | 出力文字列 | 出力変数 | ANYSTRING_SINGLE |
</contents>