ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1034

<overview>
このページは、CPUユニット内蔵データベースアクセス機能の一部である「DBCLOSE(P)命令」について説明しています。構成は以下の通りです。
- テキスト部分：DBCLOSE(P)命令の機能説明、注意事項、動作条件、トランザクションとの関係、CPUユニットパラメータの影響について詳細に記載。
- 図部分：DBCLOSE(P)命令の動作タイミングを示すタイムチャート（プログラム、命令、完了デバイスのON/OFF状態の変化）。
- 表部分：エラーコード（SD0）とその内容を示す表。
</overview>

<contents>
### テキスト
#### 機能
- (s)で指定したデータベース識別番号と対応するデータベースとの接続を切断する。
- 正常に完了すると、完了デバイス(d1)+0の完了信号がONになり、(d2)の完了ステータスに0が格納される。
- DBCLOSE(P)命令実行時の完了デバイスの動作は図の通り。

- DBTRANS(P)命令でトランザクション開始中に、DBCLOSE(P)命令を実行するとトランザクションが確定する。
- DBCLOSE(P)命令実行中はSM753（ファイルアクセス中）がONとなり、この間はDBCLOSE(P)命令は実行不可。実行した場合は無処理となる。ただし、データベースアクセス命令実行中は異常完了する。
- CPUユニットのユニットパラメータで「内蔵データベースアクセス使用有無」を“使用する”に設定し、SM1498（CPUユニット内蔵データベース起動完了フラグ）がOFFの間はDBCLOSE(P)命令は実行不可。実行した場合は無処理。

#### 注意事項
以下の場合、完了デバイス(d1)+1の異常完了信号がONになり、(d2)の完了ステータスにエラーコードが格納される。
- データベースアクセス命令実行中にDBCLOSE(P)命令を実行した場合
- (s)にて指定した識別番号が切断済みのデータベースであった場合
- (s)にて範囲外の識別番号を指定した場合

### 図
- タイムチャートで、プログラムの進行に伴いDBCLOSE(P)命令が実行されると、完了デバイス(d1)がOFFからONに変わり、その後OFFに戻る動作を示す。
- 同時に完了デバイス(d1)+1もOFFからONに変わるが、異常完了時にONになることを示している。
- 「データベースクローズ」の処理が行われるタイミングも示されている。

### 表
| エラーコード (SD0) | 内容                                   |
|--------------------|--------------------------------------|
| 2820H              | (d1)で指定した範囲が、該当デバイス/ラベルを超える場合。 |

- オペランドの完了ステータスに格納されるエラーコードの詳細は、1066ページのデータベースアクセス命令で発生するエラーコードを参照。
</contents>