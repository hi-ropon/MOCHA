ファイル名: MELSEC_iQ-R_プログラミングマニュアル（CPUユニット用命令_汎用FUN_汎用FB編）_page1160

<overview>
本ページは「コントロールデータ」と「機能」に関する説明で構成されています。ページ上部に2つの表があり、オペランド(s2)と(d1)のデバイスごとの項目内容と設定範囲、セット側の情報が示されています。中段には「Point」として注意事項が記載されています。下部は「機能」説明で、SP.SOCRCV命令の動作概要、受信データの読み出し方法、完了デバイスの動作、命令の実行タイミングを示す図解が含まれています。テキスト説明と図解が混在し、表、テキスト、図の3つのセクションで構成されています。
</overview>

<contents>
### テキスト・表
#### コントロールデータ（オペランド:s2）
| デバイス | 項目       | 内容                                                                 | 設定範囲 | セット側 |
|----------|------------|----------------------------------------------------------------------|----------|----------|
| +0       | システムエリア | —                                                                    | —        | —        |
| +1       | 完了ステータス | 命令完了時に完了ステータスを格納。<br>・0000H:正常完了<br>・0000H以外:異常完了(エラーコード) | —        | システム |

#### コントロールデータ（オペランド:d1）
| デバイス | 項目         | 内容                                                                                   | 設定範囲 | セット側 |
|----------|--------------|----------------------------------------------------------------------------------------|----------|----------|
| +0       | 受信データ長 | ソケット通信受信データエリアから読み出したデータのデータ長が格納される（バイト数）       | 0〜10238 | システム |
| +1〜+□   | 受信データ   | ソケット通信受信データエリアから読み出したデータが若いアドレスから順次格納される           | —        | システム |

*注記*  
受信データはバイト単位で下位バイト側から順に格納。奇数バイト受信時は最終データの格納エリア下位バイトに最後の受信データが入る。

#### Point
- SP.SOCRCV命令実行時、受信データのソケット通信受信データエリアからの読み出しはEND処理で行うため、命令実行にスキャンタイムの延長が発生。
- 奇数バイト受信時、最後の受信データを格納したデバイスの上位バイトは無効データとなる。

### テキスト・機能説明
- SP.SOCRCV命令のEND処理(s1)で指定したコネクションの受信データをソケット通信受信データエリアから読み出す。
- 受信データはCPUユニット内の(d1)+0に受信データ長、(d1)+1以降に受信データが格納される。
- SP.SOCRCV命令の正常完了・異常完了は設定データで指定した完了デバイス(d2)および完了時の状態表示デバイス(d2)+1で確認可能。
  - 完了デバイス(d2): 命令完了時にON、次のEND処理でOFF。
  - 状態表示デバイス(d2)+1: 命令完了時の状態によりON/OFF制御。正常完了時はOFFのまま、異常完了時はON。
- 命令の実行タイミングはシーケンススキャンの中で、命令実行→データ受信→データ読出し→完了デバイスON/OFFの流れで行われる。

### 図解説明
- CPUユニット内の(d1)+0に受信データ長、(d1)+1以降に受信データが格納される構造を示す。
- ソケット通信受信データエリアから(s1)で指定したコネクション番号のデータを受信し、CPUユニットに読み出す流れを矢印で表現。
- シーケンススキャンのタイミングチャートでは、SP.SOCRCV命令の命令実行時に完了デバイス(d2)と状態表示デバイス(d2)+1がOFFからONになり、データ受信と読出しのタイミングが示されている。
- 正常完了時は完了デバイスが1スキャンONし、その後OFFに戻る。異常完了時は状態表示デバイスがONになる。

</contents>